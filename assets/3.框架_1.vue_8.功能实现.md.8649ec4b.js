import{_ as s,o as a,c as n,a as l}from"./app.bfa9bd4b.js";const u=JSON.parse('{"title":"功能实现","description":"","frontmatter":{},"headers":[{"level":2,"title":"实现js控制上传文件","slug":"实现js控制上传文件","link":"#实现js控制上传文件","children":[]},{"level":2,"title":"element-ui消息提示$message重叠问题","slug":"element-ui消息提示-message重叠问题","link":"#element-ui消息提示-message重叠问题","children":[]},{"level":2,"title":"安装xlsx","slug":"安装xlsx","link":"#安装xlsx","children":[]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[]},{"level":2,"title":"处理JSON和JS数据","slug":"处理json和js数据","link":"#处理json和js数据","children":[{"level":3,"title":"创建新工作簿","slug":"创建新工作簿","link":"#创建新工作簿","children":[]}]},{"level":2,"title":"vue文本识别 “ \\\\n ” 换行","slug":"vue文本识别-n-换行","link":"#vue文本识别-n-换行","children":[{"level":3,"title":"1.使用css实现","slug":"_1-使用css实现","link":"#_1-使用css实现","children":[]},{"level":3,"title":"2.使用v-html实现","slug":"_2-使用v-html实现","link":"#_2-使用v-html实现","children":[]}]},{"level":2,"title":"","slug":"","link":"#","children":[]}],"relativePath":"3.框架/1.vue/8.功能实现.md","lastUpdated":1720835436690}'),p={name:"3.框架/1.vue/8.功能实现.md"},o=l(`<h1 id="功能实现" tabindex="-1">功能实现 <a class="header-anchor" href="#功能实现" aria-hidden="true">#</a></h1><h2 id="实现js控制上传文件" tabindex="-1">实现js控制上传文件 <a class="header-anchor" href="#实现js控制上传文件" aria-hidden="true">#</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#abb2bf;"></span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#b392f0;"></span></span>
<span class="line"><span style="color:#b392f0;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="element-ui消息提示-message重叠问题" tabindex="-1">element-ui消息提示$message重叠问题 <a class="header-anchor" href="#element-ui消息提示-message重叠问题" aria-hidden="true">#</a></h2><p>函数中程序同步执行，先后触发两个$message，此时两个$message的弹窗重叠</p><p>这是因为vue的异步更新队列有缓冲机制，第一次$message触发时，并没有更新dom，导致第二个$message取item.$el.offsetHeight取到的高度为0，所以第二个$message只是下移了默认的offset(即16px)，并没有加上第一个$message的offsetHeight。</p><p>使用setTimeout解决</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">files</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">file</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">files</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">size</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">maxFileSize</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">formData</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">append</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;fileList&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">file</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#61AFEF;">setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">$message</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;success&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                  </span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;文件大小限制（10MB）：&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                });</span></span>
<span class="line"><span style="color:#ABB2BF;">              }, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">          }</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">for</span><span style="color:#B392F0;"> (</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> i </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">files</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">length</span><span style="color:#B392F0;">; i</span><span style="color:#F97583;">++</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">file</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> files[i];</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">file</span><span style="color:#B392F0;">.size </span><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;"> maxFileSize) {</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">formData</span><span style="color:#B392F0;">.append(</span><span style="color:#FFAB70;">&#39;fileList&#39;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> file);</span></span>
<span class="line"><span style="color:#B392F0;">            } </span><span style="color:#F97583;">else</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">              setTimeout(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">                </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">$message</span><span style="color:#B392F0;">.warning({</span></span>
<span class="line"><span style="color:#B392F0;">                  type</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;success&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">                  message</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;文件大小限制（10MB）：&#39;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">+</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">file</span><span style="color:#B392F0;">.name</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">                });</span></span>
<span class="line"><span style="color:#B392F0;">              }</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> i </span><span style="color:#F97583;">*</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">50</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">            }</span></span>
<span class="line"><span style="color:#B392F0;">          }</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="安装xlsx" tabindex="-1">安装xlsx <a class="header-anchor" href="#安装xlsx" aria-hidden="true">#</a></h2><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-s</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">xlsx</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm </span><span style="color:#9DB1C5;">i</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">-s</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">xlsx</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// Acquire Data (reference to the HTML table)</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">table_elt</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;my-table-id&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Extract Data (create a workbook object from the table)</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">table_to_book</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">table_elt</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Process Data (add a new row)</span></span>
<span class="line"><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Sheets</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sheet_add_aoa</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, [[</span><span style="color:#98C379;">&quot;Created &quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toISOString</span><span style="color:#ABB2BF;">()]], { </span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> })</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Package and Release Data (\`writeFile\` tries to write and save an XLSB file)</span></span>
<span class="line"><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Report.xlsb&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;">// Acquire Data (reference to the HTML table)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">table_elt</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">document</span><span style="color:#B392F0;">.getElementById(</span><span style="color:#FFAB70;">&quot;my-table-id&quot;</span><span style="color:#B392F0;">)</span></span>
<span class="line"><span style="color:#6B737C;">// Extract Data (create a workbook object from the table)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.table_to_book(table_elt)</span></span>
<span class="line"><span style="color:#6B737C;">// Process Data (add a new row)</span></span>
<span class="line"><span style="color:#B392F0;">c ws </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;">.Sheets[</span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">]</span></span>
<span class="line"><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.sheet_add_aoa(ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> [[</span><span style="color:#FFAB70;">&quot;Created &quot;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">+</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date().toISOString()]]</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> { origin</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">-</span><span style="color:#F8F8F8;">1</span><span style="color:#B392F0;"> })</span></span>
<span class="line"><span style="color:#6B737C;">// Package and Release Data (\`writeFile\` tries to write and save an XLSB file)</span></span>
<span class="line"><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(workbook</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Report.xlsb&quot;</span><span style="color:#B392F0;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="处理json和js数据" tabindex="-1">处理JSON和JS数据 <a class="header-anchor" href="#处理json和js数据" aria-hidden="true">#</a></h2><p>JSON和JS数据往往表示单个工作表。本节将使用一些实用函数来生成工作簿</p><h3 id="创建新工作簿" tabindex="-1">创建新工作簿 <a class="header-anchor" href="#创建新工作簿" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> workbook </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>book_new函数创建一个没有工作表的空工作簿 电子表格软件通常至少需要一份工作表，并在用户界面中强制执行该要求。xlsx库在写入时强制执行该要求，如果将空工作簿传递给写入函数，则会引发错误</p><p>JS数组创建工作表</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">aoa_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">aoa</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">opts</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> worksheet </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.aoa_to_sheet(aoa</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> opts)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>以下代码生成了一个工作表，其中单元格A1设置为字符串A1，单元格B1设置为B1，等等：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">aoa_to_sheet</span><span style="color:#ABB2BF;">([</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C1&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A2&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B2&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C2&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A3&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B3&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C3&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> worksheet </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.aoa_to_sheet([</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A1&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B1&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C1&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A2&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B2&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C2&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A3&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B3&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C3&quot;</span><span style="color:#B392F0;">]</span></span>
<span class="line"><span style="color:#B392F0;">])</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>aoa_to_sheet默认情况下，为数组中的每个对象生成一个标题行和一行。可选opts参数具有控制列顺序和标题输出的设置</p><h2 id="vue文本识别-n-换行" tabindex="-1">vue文本识别 “ \\n ” 换行 <a class="header-anchor" href="#vue文本识别-n-换行" aria-hidden="true">#</a></h2><h3 id="_1-使用css实现" tabindex="-1">1.使用css实现 <a class="header-anchor" href="#_1-使用css实现" aria-hidden="true">#</a></h3><div class="language-css line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#E06C75;">white-space</span><span style="color:#C678DD;">: </span><span style="color:#E06C75;">pre-wrap</span><span style="color:#C678DD;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#FFAB70;">white-space</span><span style="color:#B392F0;">: </span><span style="color:#FFAB70;">pre-wrap</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-使用v-html实现" tabindex="-1">2.使用v-html实现 <a class="header-anchor" href="#_2-使用v-html实现" aria-hidden="true">#</a></h3><p>首先，将字符串里的\\n替换为<code>&lt;br&gt;</code>，然后用v-html指令渲染字符串为innerHTML</p><p>JS部分</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">text</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/\\n/</span><span style="color:#C678DD;">g</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&lt;br&gt;&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.text </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">data</span><span style="color:#B392F0;">.replace(</span><span style="color:#FFAB70;">/\\n/</span><span style="color:#F97583;">g</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;&lt;br&gt;&#39;</span><span style="color:#B392F0;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>HTML部分</p><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">v-html</span><span style="color:#ABB2BF;">=</span><span style="color:#ABB2BF;">&quot;</span><span style="color:#E06C75;">text</span><span style="color:#ABB2BF;">&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">div</span><span style="color:#B392F0;"> v-html</span><span style="color:#F97583;">=</span><span style="color:#B392F0;">&quot;</span><span style="color:#B392F0;">text</span><span style="color:#B392F0;">&quot;</span><span style="color:#B392F0;">&gt;&lt;/</span><span style="color:#FFAB70;">div</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h2>`,32),e=[o];function t(r,c,B,y,i,F){return a(),n("div",null,e)}const A=s(p,[["render",t]]);export{u as __pageData,A as default};
