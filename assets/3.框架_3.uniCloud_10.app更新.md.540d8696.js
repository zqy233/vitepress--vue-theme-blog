import{_ as s,o as n,c as a,a as l}from"./app.bfa9bd4b.js";const p="/zqy-blog/assets/image-20230214165042223.a9be435b.png",o="/zqy-blog/assets/image-20230214163315613.a4b95e02.png",t="/zqy-blog/assets/image-20230214163423585.992ba1e1.png",e="/zqy-blog/assets/image-20230214174720544.bf07452d.png",m=JSON.parse('{"title":"app检查更新与升级","description":"","frontmatter":{},"headers":[{"level":2,"title":"app升级方式","slug":"app升级方式","link":"#app升级方式","children":[]},{"level":2,"title":"整包升级与应用资源的升级区别","slug":"整包升级与应用资源的升级区别","link":"#整包升级与应用资源的升级区别","children":[]},{"level":2,"title":"如何打包apk/ipa资源包","slug":"如何打包apk-ipa资源包","link":"#如何打包apk-ipa资源包","children":[]},{"level":2,"title":"如何打包wgt资源包","slug":"如何打包wgt资源包","link":"#如何打包wgt资源包","children":[{"level":3,"title":"如何查看wgt文件manifest.json","slug":"如何查看wgt文件manifest-json","link":"#如何查看wgt文件manifest-json","children":[]}]},{"level":2,"title":"什么是升级中心uni-upgrade-center","slug":"什么是升级中心uni-upgrade-center","link":"#什么是升级中心uni-upgrade-center","children":[]},{"level":2,"title":"怎么使用uni-upgrade-center","slug":"怎么使用uni-upgrade-center","link":"#怎么使用uni-upgrade-center","children":[]},{"level":2,"title":"uni-upgrade-center源码阅读","slug":"uni-upgrade-center源码阅读","link":"#uni-upgrade-center源码阅读","children":[]},{"level":2,"title":"utils/call-check-version.js","slug":"utils-call-check-version-js","link":"#utils-call-check-version-js","children":[]},{"level":2,"title":"plus.runtime.appid","slug":"plus-runtime-appid","link":"#plus-runtime-appid","children":[]},{"level":2,"title":"plus.runtime.getProperty","slug":"plus-runtime-getproperty","link":"#plus-runtime-getproperty","children":[{"level":3,"title":"参数：","slug":"参数","link":"#参数","children":[]},{"level":3,"title":"示例：","slug":"示例","link":"#示例","children":[]}]},{"level":2,"title":"utils/call-check-version.js","slug":"utils-call-check-version-js-1","link":"#utils-call-check-version-js-1","children":[]},{"level":2,"title":"静默更新","slug":"静默更新","link":"#静默更新","children":[]},{"level":2,"title":"强制更新","slug":"强制更新","link":"#强制更新","children":[]},{"level":2,"title":"跳转应用商店","slug":"跳转应用商店","link":"#跳转应用商店","children":[]},{"level":2,"title":"用户取消下载","slug":"用户取消下载","link":"#用户取消下载","children":[]},{"level":2,"title":"报错解决：WGT安装包中manifest.json文件的version版本不匹配","slug":"报错解决-wgt安装包中manifest-json文件的version版本不匹配","link":"#报错解决-wgt安装包中manifest-json文件的version版本不匹配","children":[]},{"level":2,"title":"通过uni-admin上传wgt资源包","slug":"通过uni-admin上传wgt资源包","link":"#通过uni-admin上传wgt资源包","children":[]},{"level":2,"title":"uni-admin报错解决：超级管理员已存在","slug":"uni-admin报错解决-超级管理员已存在","link":"#uni-admin报错解决-超级管理员已存在","children":[]}],"relativePath":"3.框架/3.uniCloud/10.app更新.md","lastUpdated":1720835436694}'),r={name:"3.框架/3.uniCloud/10.app更新.md"},c=l('<h1 id="app检查更新与升级" tabindex="-1">app检查更新与升级 <a class="header-anchor" href="#app检查更新与升级" aria-hidden="true">#</a></h1><p>参考链接：</p><blockquote><p>升级中心uni-upgrade-center - App <a href="https://ext.dcloud.net.cn/plugin?id=4542" target="_blank" rel="noreferrer">https://ext.dcloud.net.cn/plugin?id=4542</a></p><p>uni-admin <a href="https://ext.dcloud.net.cn/plugin?id=4470" target="_blank" rel="noreferrer">https://ext.dcloud.net.cn/plugin?id=4470</a></p><p>h5+ api <a href="https://www.html5plus.org/doc/zh_cn/runtime.html#plus.runtime.appid" target="_blank" rel="noreferrer">https://www.html5plus.org/doc/zh_cn/runtime.html#plus.runtime.appid</a></p><p>App资源在线升级更新 <a href="https://ask.dcloud.net.cn/article/182" target="_blank" rel="noreferrer">https://ask.dcloud.net.cn/article/182</a></p><p>uni-app使用plus注意事项 <a href="https://uniapp.dcloud.net.cn/tutorial/use-html5plus.html" target="_blank" rel="noreferrer">https://uniapp.dcloud.net.cn/tutorial/use-html5plus.html</a></p><p>关于在线升级（WGT）的几个疑问 <a href="https://ask.dcloud.net.cn/question/10369" target="_blank" rel="noreferrer">https://ask.dcloud.net.cn/question/10369</a></p></blockquote><h2 id="app升级方式" tabindex="-1">app升级方式 <a class="header-anchor" href="#app升级方式" aria-hidden="true">#</a></h2><p>app应用有三种升级方式，uniapp不支持应用资源差量升级，h5+ app才支持应用资源差量升级</p><ul><li><a href="http://ask.dcloud.net.cn/article/431" target="_blank" rel="noreferrer">整包(apk/ipa)升级</a>：适用于大版本更新，新增5+模块时必须使用此类更新方法</li><li><a href="http://ask.dcloud.net.cn/article/182" target="_blank" rel="noreferrer">应用资源(wgt)升级</a>：适用于小版本更新</li><li><a href="http://ask.dcloud.net.cn/article/199" target="_blank" rel="noreferrer">应用资源差量升级</a>：适用于小版本更新</li></ul><h2 id="整包升级与应用资源的升级区别" tabindex="-1">整包升级与应用资源的升级区别 <a class="header-anchor" href="#整包升级与应用资源的升级区别" aria-hidden="true">#</a></h2><p>区别在于是否是.wgt文件</p><p>.wgt文件就是应用资源更新，.apk/,ipa文件就是整包升级</p><p>app增加了打包模块，必须整包升级</p><p>uniapp可以打包成上方这两种格式的文件</p><h2 id="如何打包apk-ipa资源包" tabindex="-1">如何打包apk/ipa资源包 <a class="header-anchor" href="#如何打包apk-ipa资源包" aria-hidden="true">#</a></h2><p>apk 安卓app软件安装包</p><p>ipa 苹果app软件安装包</p><p>最简单的打包方式就是</p><p>HBuilderX&gt;发行&gt;原生app-云打包</p><h2 id="如何打包wgt资源包" tabindex="-1">如何打包wgt资源包 <a class="header-anchor" href="#如何打包wgt资源包" aria-hidden="true">#</a></h2><p>一、更改项目<code>manifest.json</code>中的应用版本名称与应用版本号</p><p><img src="'+p+'" alt="image-20230214165042223"></p><p>二、HBuilderX&gt;发行&gt;原生App-制作应用wgt包&gt;确定</p><p><img src="'+o+'" alt="image-20230214163315613"></p><p><img src="'+t+`" alt="image-20230214163423585"></p><p>三、开发测试的时候，记得再改回原先的应用版本名称与应用版本号，不然版本跟线上的相同，安装更新包的时候就会出现<code>WGT安装包中manifest.json文件的version版本不匹配</code>，本地测试不了更新效果</p><h3 id="如何查看wgt文件manifest-json" tabindex="-1">如何查看wgt文件manifest.json <a class="header-anchor" href="#如何查看wgt文件manifest-json" aria-hidden="true">#</a></h3><p>wgt包生成后会是<code>.wgt</code>后缀名，更改其后缀名为<code>.zip</code>，再解压，就可以查看<code>manifest.json</code>了</p><h2 id="什么是升级中心uni-upgrade-center" tabindex="-1">什么是升级中心uni-upgrade-center <a class="header-anchor" href="#什么是升级中心uni-upgrade-center" aria-hidden="true">#</a></h2><blockquote><p>uniapp官方开发的App版本更新的插件，基于unicloud的后端服务</p><p>支持原生APP整包升级和wgt资源包升级</p><p>因为是开源的，通过修改源码可以实现请求java等其他后端服务，后续的源码解析章节会介绍</p></blockquote><p>升级中心分为两个部分：</p><p>前台检测更新： <a href="https://ext.dcloud.net.cn/plugin?id=4542" target="_blank" rel="noreferrer">uni-upgrade-center-app</a></p><p>后台管理系统：</p><ul><li><code>uni-admin &gt;= 1.9.3</code> ：<a href="https://ext.dcloud.net.cn/plugin?id=4470" target="_blank" rel="noreferrer">uni-admin</a> 已内置 升级中心，直接使用即可。并且云函数 <code>upgrade-center</code> 废弃，使用 <code>uni-upgrade-center</code> 云函数。</li><li><a href="https://ext.dcloud.net.cn/plugin?id=4470" target="_blank" rel="noreferrer">uni-upgrade-center Admin管理后台</a> (uni-admin 1.9.3+ 已内置，此插件不再维护) <ul><li><code>1.9.0 &lt;= uni-admin &lt; 1.9.2</code> ：请前往 <a href="https://gitee.com/dcloud/uni-upgrade-center/releases" target="_blank" rel="noreferrer">Gitee</a> 下载 <code>tag v0.5.1</code> 版本使用</li><li><code>uni-admin &lt; 1.9.0</code>：请前往 <a href="https://gitee.com/dcloud/uni-upgrade-center/releases" target="_blank" rel="noreferrer">Gitee</a> 下载 <code>tag v0.4.2</code> 版本使用</li></ul></li></ul><p>简单来说，如果是新版的uni-admin，直接用即可</p><h2 id="怎么使用uni-upgrade-center" tabindex="-1">怎么使用uni-upgrade-center <a class="header-anchor" href="#怎么使用uni-upgrade-center" aria-hidden="true">#</a></h2><p>使用我觉得并不难，跟着官方文档走即可</p><p>简单来说，就是你的app项目安装 <a href="https://ext.dcloud.net.cn/plugin?id=4542" target="_blank" rel="noreferrer">uni-upgrade-center-app</a>这个插件，同时你需要另外新建一个<code>uni-admin</code>项目，用来上传并管理app项目的更新包，app项目通过unicloud请求更新包</p><blockquote><p>官方文档<a href="https://uniapp.dcloud.net.cn/uniCloud/upgrade-center.html#uni-upgrade-center-app" target="_blank" rel="noreferrer">https://uniapp.dcloud.net.cn/uniCloud/upgrade-center.html#uni-upgrade-center-app</a></p></blockquote><p>但是如果不想使用unicloud，想换成java等其他后端服务，或者想了解app检查更新与升级的代码是如何编写的，阅读<code>uni-upgrade-center</code>源码是十分有必要的。</p><h2 id="uni-upgrade-center源码阅读" tabindex="-1"><code>uni-upgrade-center</code>源码阅读 <a class="header-anchor" href="#uni-upgrade-center源码阅读" aria-hidden="true">#</a></h2><p>十分推荐阅读<code>uni-upgrade-center</code>源码</p><p>通过一步步阅读<code>uni-upgrade-center</code>源码，基本能完全学会如何写app检查更新与升级的代码</p><p>源码前端功能实现主要分为三个文件，依次阅读</p><ol><li><code>utils/call-check-version.js</code></li><li><code>utils/call-check-version.js</code></li><li><code>pages/upgrade-popup.vue</code></li></ol><h2 id="utils-call-check-version-js" tabindex="-1"><code>utils/call-check-version.js</code> <a class="header-anchor" href="#utils-call-check-version-js" aria-hidden="true">#</a></h2><p>代码很简单，通过h5+ api获取应用信息，把应用信息传递给uniCloud云函数</p><p>同理，如果不使用云函数，传给java等后端服务的话，替换云函数部分代码就可以了</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">export</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">default</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// #ifdef APP-PLUS</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// 根据当前应用的appid，获取appid对应的应用信息</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">appid</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">widgetInfo</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">action</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;checkVersion&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">appid</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">appid</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">appVersion</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">wgtVersion</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">widgetInfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">version</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data: &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// 如果传给java等后端服务，改下方代码</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">uniCloud</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">callFunction</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;uni-upgrade-center&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">e</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;e: &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#61AFEF;">fail</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">error</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">error</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">      })</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">  })</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// #endif</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// #ifndef APP-PLUS</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;请在App中使用&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">  })</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// #endif</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">default</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> () {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// #ifdef APP-PLUS</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// 根据当前应用的appid，获取appid对应的应用信息</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.getProperty(</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.appid</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (widgetInfo) {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">data</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">        action</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;checkVersion&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        appid</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.appid</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        appVersion</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.version</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        wgtVersion</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">widgetInfo</span><span style="color:#B392F0;">.version</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;data: &quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> data);</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// 如果传给java等后端服务，改下方代码</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">uniCloud</span><span style="color:#B392F0;">.callFunction({</span></span>
<span class="line"><span style="color:#B392F0;">        name</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;uni-upgrade-center&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        data</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> (e) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;e: &quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> e);</span></span>
<span class="line"><span style="color:#B392F0;">          resolve(e)</span></span>
<span class="line"><span style="color:#B392F0;">        }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">        fail</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> (error) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">          reject(error)</span></span>
<span class="line"><span style="color:#B392F0;">        }</span></span>
<span class="line"><span style="color:#B392F0;">      })</span></span>
<span class="line"><span style="color:#B392F0;">    })</span></span>
<span class="line"><span style="color:#B392F0;">  })</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// #endif</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// #ifndef APP-PLUS</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    reject({</span></span>
<span class="line"><span style="color:#B392F0;">      message</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;请在App中使用&#39;</span></span>
<span class="line"><span style="color:#B392F0;">    })</span></span>
<span class="line"><span style="color:#B392F0;">  })</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// #endif</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="plus-runtime-appid" tabindex="-1">plus.runtime.appid <a class="header-anchor" href="#plus-runtime-appid" aria-hidden="true">#</a></h2><p>当前应用的APPID</p><p>String 类型 只读属性</p><p>注意，如果是在HBuilder真机运行获取的是固定值&quot;HBuilder&quot;，需要提交App云端打包后运行才能获取真实的APPID值</p><h2 id="plus-runtime-getproperty" tabindex="-1">plus.runtime.getProperty <a class="header-anchor" href="#plus-runtime-getproperty" aria-hidden="true">#</a></h2><p>获取指定APPID对应的应用信息</p><h3 id="参数" tabindex="-1">参数： <a class="header-anchor" href="#参数" aria-hidden="true">#</a></h3><ul><li>appid: ( String ) 必选 应用的Appid</li><li>getPropertyCB: ( <a href="https://www.html5plus.org/doc/zh_cn/runtime.html#plus.runtime.GetPropertyCallBack" target="_blank" rel="noreferrer">GetPropertyCallBack</a> ) 必选 获得应用信息成功回调函数</li></ul><h3 id="示例" tabindex="-1">示例： <a class="header-anchor" href="#示例" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 获取应用信息</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">getAppInfo</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getProperty</span><span style="color:#ABB2BF;">( </span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">appid</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> ( </span><span style="color:#E06C75;font-style:italic;">wgtinfo</span><span style="color:#ABB2BF;"> ) {</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//appid属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">var</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;appid:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">appid</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//version属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;version:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//name属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;name:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//description属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;description:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">description</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//author属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;author:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">author</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//email属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;email:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">email</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#7F848E;font-style:italic;">//features 属性</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&lt;br/&gt;features:&quot;</span><span style="color:#56B6C2;">+</span><span style="color:#E5C07B;">wgtinfo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">features</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">( </span><span style="color:#E06C75;">wgtStr</span><span style="color:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#ABB2BF;">	} );</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;">// 获取应用信息</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> getAppInfo() {</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.getProperty( </span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.appid</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> ( wgtinfo ) {</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//appid属性</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#F97583;">var</span><span style="color:#B392F0;"> wgtStr </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;appid:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.appid;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//version属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;version:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.version;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//name属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;name:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.name;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//description属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;description:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.description;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//author属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;author:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.author;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//email属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;email:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.email;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#6B737C;">//features 属性</span></span>
<span class="line"><span style="color:#B392F0;">		wgtStr </span><span style="color:#F97583;">+=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&lt;br/&gt;features:&quot;</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">wgtinfo</span><span style="color:#B392F0;">.features;</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log( wgtStr );</span></span>
<span class="line"><span style="color:#B392F0;">	} );</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="utils-call-check-version-js-1" tabindex="-1"><code>utils/call-check-version.js</code> <a class="header-anchor" href="#utils-call-check-version-js-1" aria-hidden="true">#</a></h2><p>官方实现了两种方式，静默更新和提示更新</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">callCheckVersion</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;./call-check-version&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 推荐在App.vue中使用</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">PACKAGE_INFO_KEY</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;__package_info__&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">default</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#7F848E;font-style:italic;">// #ifdef APP-PLUS</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">callCheckVersion</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">e</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">code</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">message</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">is_silently</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 是否静默更新</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">platform</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包平台</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">// 安装包类型</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#7F848E;font-style:italic;">// 此处逻辑仅为实例，可自行编写</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">code</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">// 腾讯云和阿里云下载链接不同，需要处理一下，阿里云会原样返回</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E5C07B;">fileList</span></span>
<span class="line"><span style="color:#ABB2BF;">				} </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">uniCloud</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getTempFileURL</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E06C75;">fileList</span><span style="color:#ABB2BF;">: [</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">				});</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fileList</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">tempFileURL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">fileList</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">tempFileURL</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">// 静默更新，只有wgt有</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">is_silently</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">downloadFile</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">statusCode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#7F848E;font-style:italic;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">install</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">tempFilePath</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">									</span><span style="color:#E06C75;">force</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">								});</span></span>
<span class="line"><span style="color:#ABB2BF;">							}</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					});</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 * 提示升级一</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 * 使用 uni.showModal</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 */</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">// return updateUseModal(e.result)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 * 提示升级二</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 * 官方适配的升级弹窗，可自行替换资源适配UI风格</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				 */</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setStorageSync</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PACKAGE_INFO_KEY</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">navigateTo</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">\`/uni_modules/uni-upgrade-center-app/pages/upgrade-popup?local_storage_key=</span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">PACKAGE_INFO_KEY</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#61AFEF;">fail</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;更新弹框跳转失败&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">removeStorageSync</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">PACKAGE_INFO_KEY</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">				})</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">code</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">// TODO 云函数报错处理</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		}).</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#7F848E;font-style:italic;">// TODO 云函数报错处理</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">err</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		})</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#7F848E;font-style:italic;">// #endif</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 使用 uni.showModal 升级</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">updateUseModal</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">packageInfo</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 标题</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">contents</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 升级内容</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">is_mandatory</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 是否强制更新</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">platform</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包平台</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">// 安装包类型</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">packageInfo</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isWGT</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">===</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;wgt&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">isWGT</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">platform</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;iOS&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">confirmText</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;立即跳转更新&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;立即下载更新&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">content</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">contents</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">showCancel</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">is_mandatory</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">confirmText</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cancel</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#7F848E;font-style:italic;">// 安装包下载</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">openURL</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showToast</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;后台下载中……&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E06C75;">duration</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1000</span></span>
<span class="line"><span style="color:#ABB2BF;">			});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#7F848E;font-style:italic;">// wgt 和 安卓下载更新</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#E06C75;">downloadTask</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">downloadFile</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">statusCode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;下载安装包失败&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#7F848E;font-style:italic;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">install</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">tempFilePath</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E06C75;">force</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">					}, () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">is_mandatory</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#7F848E;font-style:italic;">//更新完重启app</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">restart</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;安装成功是否重启？&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">confirm</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">									</span><span style="color:#7F848E;font-style:italic;">//更新完重启app</span></span>
<span class="line"><span style="color:#ABB2BF;">									</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">restart</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">								}</span></span>
<span class="line"><span style="color:#ABB2BF;">							}</span></span>
<span class="line"><span style="color:#ABB2BF;">						});</span></span>
<span class="line"><span style="color:#ABB2BF;">					}, </span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;更新失败&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">content</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">err</span></span>
<span class="line"><span style="color:#ABB2BF;">								.</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">showCancel</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">						});</span></span>
<span class="line"><span style="color:#ABB2BF;">					});</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			});</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#B392F0;"> callCheckVersion </span><span style="color:#F97583;">from</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;./call-check-version&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// 推荐在App.vue中使用</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">PACKAGE_INFO_KEY</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;__package_info__&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">default</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;">() {</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#6B737C;">// #ifdef APP-PLUS</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">		callCheckVersion().then(</span><span style="color:#F97583;">async</span><span style="color:#B392F0;"> (e) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#F97583;">!</span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.result) </span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">code</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">message</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">is_silently</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 是否静默更新</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">url</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">platform</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包平台</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">type</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包类型</span></span>
<span class="line"><span style="color:#B392F0;">			} </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.result;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#6B737C;">// 此处逻辑仅为实例，可自行编写</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (code </span><span style="color:#F97583;">&gt;</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">// 腾讯云和阿里云下载链接不同，需要处理一下，阿里云会原样返回</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#79B8FF;">fileList</span></span>
<span class="line"><span style="color:#B392F0;">				} </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">uniCloud</span><span style="color:#B392F0;">.getTempFileURL({</span></span>
<span class="line"><span style="color:#B392F0;">					fileList</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> [url]</span></span>
<span class="line"><span style="color:#B392F0;">				});</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (fileList[</span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">].tempFileURL)</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">result</span><span style="color:#B392F0;">.url </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> fileList[</span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">].tempFileURL;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">				resolve(e)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">// 静默更新，只有wgt有</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (is_silently) {</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.downloadFile({</span></span>
<span class="line"><span style="color:#B392F0;">						url</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">result</span><span style="color:#B392F0;">.url</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">						success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.statusCode </span><span style="color:#F97583;">==</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">200</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">								</span><span style="color:#6B737C;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#B392F0;">								</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.install(</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.tempFilePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">									force</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">								});</span></span>
<span class="line"><span style="color:#B392F0;">							}</span></span>
<span class="line"><span style="color:#B392F0;">						}</span></span>
<span class="line"><span style="color:#B392F0;">					});</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">				}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">/**</span></span>
<span class="line"><span style="color:#6B737C;">				 * 提示升级一</span></span>
<span class="line"><span style="color:#6B737C;">				 * 使用 uni.showModal</span></span>
<span class="line"><span style="color:#6B737C;">				 */</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">// return updateUseModal(e.result)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">/**</span></span>
<span class="line"><span style="color:#6B737C;">				 * 提示升级二</span></span>
<span class="line"><span style="color:#6B737C;">				 * 官方适配的升级弹窗，可自行替换资源适配UI风格</span></span>
<span class="line"><span style="color:#6B737C;">				 */</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.setStorageSync(</span><span style="color:#79B8FF;">PACKAGE_INFO_KEY</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.result)</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.navigateTo({</span></span>
<span class="line"><span style="color:#B392F0;">					url</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">\`/uni_modules/uni-upgrade-center-app/pages/upgrade-popup?local_storage_key=</span><span style="color:#F97583;">\${</span><span style="color:#79B8FF;">PACKAGE_INFO_KEY</span><span style="color:#F97583;">}</span><span style="color:#FFAB70;">\`</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">					fail</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> (err) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.error(</span><span style="color:#FFAB70;">&#39;更新弹框跳转失败&#39;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> err)</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.removeStorageSync(</span><span style="color:#79B8FF;">PACKAGE_INFO_KEY</span><span style="color:#B392F0;">)</span></span>
<span class="line"><span style="color:#B392F0;">					}</span></span>
<span class="line"><span style="color:#B392F0;">				})</span></span>
<span class="line"><span style="color:#B392F0;">				</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#B392F0;">			} </span><span style="color:#F97583;">else</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (code </span><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#6B737C;">// TODO 云函数报错处理</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.error(message)</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> reject(e)</span></span>
<span class="line"><span style="color:#B392F0;">			}</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> resolve(e)</span></span>
<span class="line"><span style="color:#B392F0;">		}).catch(err </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#6B737C;">// TODO 云函数报错处理</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.error(</span><span style="color:#79B8FF;">err</span><span style="color:#B392F0;">.message)</span></span>
<span class="line"><span style="color:#B392F0;">			reject(err)</span></span>
<span class="line"><span style="color:#B392F0;">		})</span></span>
<span class="line"><span style="color:#B392F0;">	});</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#6B737C;">// #endif</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">/**</span></span>
<span class="line"><span style="color:#6B737C;"> * 使用 uni.showModal 升级</span></span>
<span class="line"><span style="color:#6B737C;"> */</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> updateUseModal(packageInfo) {</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">title</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 标题</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">contents</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 升级内容</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">is_mandatory</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 是否强制更新</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">url</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">platform</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包平台</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">type</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包类型</span></span>
<span class="line"><span style="color:#B392F0;">	} </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> packageInfo;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> isWGT </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> type </span><span style="color:#F97583;">===</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;wgt&#39;</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> isiOS </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">isWGT </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">platform</span><span style="color:#B392F0;">.includes(</span><span style="color:#FFAB70;">&#39;iOS&#39;</span><span style="color:#B392F0;">) </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> confirmText </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> isiOS </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;立即跳转更新&#39;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;立即下载更新&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">		title</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		content</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> contents</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		showCancel</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">is_mandatory</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		confirmText</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.cancel) </span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#6B737C;">// 安装包下载</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (isiOS) {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.openURL(url);</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showToast({</span></span>
<span class="line"><span style="color:#B392F0;">				title</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;后台下载中……&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">				duration</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">1000</span></span>
<span class="line"><span style="color:#B392F0;">			});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#6B737C;">// wgt 和 安卓下载更新</span></span>
<span class="line"><span style="color:#B392F0;">			downloadTask </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.downloadFile({</span></span>
<span class="line"><span style="color:#B392F0;">				url</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">				success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.statusCode </span><span style="color:#F97583;">!==</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">200</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.error(</span><span style="color:#FFAB70;">&#39;下载安装包失败&#39;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> err);</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">					}</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#6B737C;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.install(</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.tempFilePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						force</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">					}</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (is_mandatory) {</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#6B737C;">//更新完重启app</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.restart();</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">						}</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">							title</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;安装成功是否重启？&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">								</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.confirm) {</span></span>
<span class="line"><span style="color:#B392F0;">									</span><span style="color:#6B737C;">//更新完重启app</span></span>
<span class="line"><span style="color:#B392F0;">									</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.restart();</span></span>
<span class="line"><span style="color:#B392F0;">								}</span></span>
<span class="line"><span style="color:#B392F0;">							}</span></span>
<span class="line"><span style="color:#B392F0;">						});</span></span>
<span class="line"><span style="color:#B392F0;">					}</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> err </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">							title</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;更新失败&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							content</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> err</span></span>
<span class="line"><span style="color:#B392F0;">								.message</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							showCancel</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">						});</span></span>
<span class="line"><span style="color:#B392F0;">					});</span></span>
<span class="line"><span style="color:#B392F0;">				}</span></span>
<span class="line"><span style="color:#B392F0;">			});</span></span>
<span class="line"><span style="color:#B392F0;">		}</span></span>
<span class="line"><span style="color:#B392F0;">	});</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br></div></div><h2 id="静默更新" tabindex="-1">静默更新 <a class="header-anchor" href="#静默更新" aria-hidden="true">#</a></h2><p>可以看出静默更新分为三步：</p><ol><li>后端提供一个下载更新包的url</li><li>前端<code>uni.downloadFile</code>该url地址</li><li>下载好后前端调用<code>plus.runtime.install</code>安装更新包</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 静默更新，只有wgt有</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">is_silently</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">downloadFile</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">statusCode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#7F848E;font-style:italic;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">install</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">tempFilePath</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#E06C75;">force</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">							});</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">				});</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;">// 静默更新，只有wgt有</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (is_silently) {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.downloadFile({</span></span>
<span class="line"><span style="color:#B392F0;">					url</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">result</span><span style="color:#B392F0;">.url</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">					success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.statusCode </span><span style="color:#F97583;">==</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">200</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#6B737C;">// 下载好直接安装，下次启动生效</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.install(</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.tempFilePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">								force</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">							});</span></span>
<span class="line"><span style="color:#B392F0;">						}</span></span>
<span class="line"><span style="color:#B392F0;">					}</span></span>
<span class="line"><span style="color:#B392F0;">				});</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">			}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="强制更新" tabindex="-1">强制更新 <a class="header-anchor" href="#强制更新" aria-hidden="true">#</a></h2><p>首先，我们需要知道的是，<code>plus.runtime.install</code>成功后就已经安装完更新包了，用户下次打开app就会是最新版的app，这里强制更新的意思是是否立刻重启app，强制用户立刻使用最新版app</p><p><code>plus.runtime.install</code>后有三种应用场景，这里官方写的很好，三种场景都处理了：</p><ol><li>不征求客户意见，直接重启app，强制用户立刻使用最新版</li><li>征求客户意见，如果重启，用户使用最新版，如果不重启，等用户下次打开app显示最新版</li><li>不重启，等用户下次打开app显示最新版</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">			    </span><span style="color:#7F848E;font-style:italic;">// 安装下载的安装包，下次启动生效</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">install</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">tempFilePath</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E06C75;">force</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">					}, () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// is_mandatory是后端返回的控制是否强制更新的变量</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 强制更新就是强制重启app，否则就是用户下次打开app才会更新</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 强制更新体验不好，还是下次打开更新会好很多</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">is_mandatory</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#7F848E;font-style:italic;">// 更新完重启app</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">restart</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;安装成功是否重启？&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">confirm</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">									</span><span style="color:#7F848E;font-style:italic;">// 更新完重启app</span></span>
<span class="line"><span style="color:#ABB2BF;">									</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">restart</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">								}</span></span>
<span class="line"><span style="color:#ABB2BF;">							}</span></span>
<span class="line"><span style="color:#ABB2BF;">						});</span></span>
<span class="line"><span style="color:#ABB2BF;">					}, </span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;更新失败&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">content</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">err</span></span>
<span class="line"><span style="color:#ABB2BF;">								.</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">showCancel</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">						});</span></span>
<span class="line"><span style="color:#ABB2BF;">					});</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">			    </span><span style="color:#6B737C;">// 安装下载的安装包，下次启动生效</span></span>
<span class="line"><span style="color:#B392F0;">					</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.install(</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.tempFilePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						force</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">					}</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#6B737C;">// is_mandatory是后端返回的控制是否强制更新的变量</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#6B737C;">// 强制更新就是强制重启app，否则就是用户下次打开app才会更新</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#6B737C;">// 强制更新体验不好，还是下次打开更新会好很多</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (is_mandatory) {</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#6B737C;">// 更新完重启app</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.restart();</span></span>
<span class="line"><span style="color:#B392F0;">							</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">						}</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">							title</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;安装成功是否重启？&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">								</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.confirm) {</span></span>
<span class="line"><span style="color:#B392F0;">									</span><span style="color:#6B737C;">// 更新完重启app</span></span>
<span class="line"><span style="color:#B392F0;">									</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.restart();</span></span>
<span class="line"><span style="color:#B392F0;">								}</span></span>
<span class="line"><span style="color:#B392F0;">							}</span></span>
<span class="line"><span style="color:#B392F0;">						});</span></span>
<span class="line"><span style="color:#B392F0;">					}</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> err </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">						</span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">							title</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;更新失败&#39;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							content</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> err</span></span>
<span class="line"><span style="color:#B392F0;">								.message</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">							showCancel</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">						});</span></span>
<span class="line"><span style="color:#B392F0;">					});</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="跳转应用商店" tabindex="-1">跳转应用商店 <a class="header-anchor" href="#跳转应用商店" aria-hidden="true">#</a></h2><ol><li>后端返回安装包平台和安装包类型</li><li>安装包类型是否是<code>wgt</code>，如果不是，判断安装包平台是否包含<code>iOS</code>，调用第三方程序打开url安装<code>iOS</code>更新包，<code>iOS</code>是跳转更新，其他是下载更新</li><li>ios需要上架、通过市场安装，所以需要第三方程序打开url</li></ol><p><code>plus.runtime.openURL</code>表示调用第三方程序打开url进行安装，即跳转应用商店功能</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">updateUseModal</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">packageInfo</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">title</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 标题</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">contents</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 升级内容</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">is_mandatory</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 是否强制更新</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">url</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">platform</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 安装包平台</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">// 安装包类型</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">packageInfo</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isWGT</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">===</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;wgt&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">isWGT</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">platform</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;iOS&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">confirmText</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;立即跳转更新&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;立即下载更新&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showModal</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">content</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">contents</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">showCancel</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">is_mandatory</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E06C75;">confirmText</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cancel</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#7F848E;font-style:italic;">// 安装包下载</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">isiOS</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#E5C07B;">plus</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">runtime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">openURL</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">      ...</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> updateUseModal(packageInfo) {</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">title</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 标题</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">contents</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 升级内容</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">is_mandatory</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 是否强制更新</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">url</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包下载地址</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">platform</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包平台</span></span>
<span class="line"><span style="color:#B392F0;">		</span><span style="color:#79B8FF;">type</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// 安装包类型</span></span>
<span class="line"><span style="color:#B392F0;">	} </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> packageInfo;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> isWGT </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> type </span><span style="color:#F97583;">===</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;wgt&#39;</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> isiOS </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">isWGT </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">platform</span><span style="color:#B392F0;">.includes(</span><span style="color:#FFAB70;">&#39;iOS&#39;</span><span style="color:#B392F0;">) </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> confirmText </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> isiOS </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;立即跳转更新&#39;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;立即下载更新&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">	</span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.showModal({</span></span>
<span class="line"><span style="color:#B392F0;">		title</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		content</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> contents</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		showCancel</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">is_mandatory</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		confirmText</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">		success</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">res</span><span style="color:#B392F0;">.cancel) </span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#6B737C;">// 安装包下载</span></span>
<span class="line"><span style="color:#B392F0;">			</span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (isiOS) {</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#79B8FF;">plus</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">runtime</span><span style="color:#B392F0;">.openURL(url);</span></span>
<span class="line"><span style="color:#B392F0;">				</span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">			}</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">...</span></span>
<span class="line"><span style="color:#B392F0;">		}</span></span>
<span class="line"><span style="color:#B392F0;">	});</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="用户取消下载" tabindex="-1">用户取消下载 <a class="header-anchor" href="#用户取消下载" aria-hidden="true">#</a></h2><blockquote><p><a href="https://uniapp.dcloud.net.cn/api/request/network-file.html#downloadfile" target="_blank" rel="noreferrer">https://uniapp.dcloud.net.cn/api/request/network-file.html#downloadfile</a></p></blockquote><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">downloadTask</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">uni</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">downloadFile</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://www.example.com/file/test&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">//仅为示例，并非真实接口地址。</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">complete</span><span style="color:#ABB2BF;">: ()</span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#E5C07B;">downloadTask</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">abort</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">var</span><span style="color:#B392F0;"> downloadTask </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">uni</span><span style="color:#B392F0;">.downloadFile({</span></span>
<span class="line"><span style="color:#B392F0;">	url</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&#39;https://www.example.com/file/test&#39;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">//仅为示例，并非真实接口地址。</span></span>
<span class="line"><span style="color:#B392F0;">	complete</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ()</span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {}</span></span>
<span class="line"><span style="color:#B392F0;">});</span></span>
<span class="line"><span style="color:#79B8FF;">downloadTask</span><span style="color:#B392F0;">.abort();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="报错解决-wgt安装包中manifest-json文件的version版本不匹配" tabindex="-1">报错解决：WGT安装包中manifest.json文件的version版本不匹配 <a class="header-anchor" href="#报错解决-wgt安装包中manifest-json文件的version版本不匹配" aria-hidden="true">#</a></h2><p><code>manifest.json</code>中的版本大于等于了线上的版本，自行排查即可</p><h2 id="通过uni-admin上传wgt资源包" tabindex="-1">通过uni-admin上传wgt资源包 <a class="header-anchor" href="#通过uni-admin上传wgt资源包" aria-hidden="true">#</a></h2><blockquote><p><a href="https://ext.dcloud.net.cn/plugin?id=4470" target="_blank" rel="noreferrer">https://ext.dcloud.net.cn/plugin?id=4470</a></p></blockquote><p><img src="`+e+'" alt="image-20230214174720544"></p><h2 id="uni-admin报错解决-超级管理员已存在" tabindex="-1">uni-admin报错解决：超级管理员已存在 <a class="header-anchor" href="#uni-admin报错解决-超级管理员已存在" aria-hidden="true">#</a></h2><p><a href="https://ask.dcloud.net.cn/question/153641" target="_blank" rel="noreferrer">https://ask.dcloud.net.cn/question/153641</a></p><p>是因为admin账户是旧的，跟appid对不上，删除旧的admin账户，重新创建</p>',83),B=[c];function y(i,F,u,A,b,d){return n(),a("div",null,B)}const E=s(r,[["render",y]]);export{m as __pageData,E as default};
