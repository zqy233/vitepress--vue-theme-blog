import{_ as s,o as a,c as n,a as l}from"./app.bfa9bd4b.js";const u=JSON.parse('{"title":"JQL","description":"","frontmatter":{},"headers":[{"level":3,"title":"新增数据","slug":"新增数据","link":"#新增数据","children":[]},{"level":2,"title":"云函数传统方式和jql语法操作数据库的区别","slug":"云函数传统方式和jql语法操作数据库的区别","link":"#云函数传统方式和jql语法操作数据库的区别","children":[]},{"level":2,"title":"HBuilderX的JQL数据库管理器","slug":"hbuilderx的jql数据库管理器","link":"#hbuilderx的jql数据库管理器","children":[]}],"relativePath":"3.框架/3.uniCloud/4.JQL语法.md","lastUpdated":1720835436694}'),e={name:"3.框架/3.uniCloud/4.JQL语法.md"},o=l(`<h1 id="jql" tabindex="-1">JQL <a class="header-anchor" href="#jql" aria-hidden="true">#</a></h1><p><code>JQL</code>，全称 javascript query language，是一种js方式操作数据库的规范</p><ul><li><code>JQL</code>大幅降低了js工程师操作数据库的难度，比SQL和传统MongoDB API更清晰、易掌握</li><li><code>JQL</code>支持强大的<a href="https://uniapp.dcloud.net.cn/uniCloud/schema" target="_blank" rel="noreferrer">DB Schema</a>，内置数据规则和权限。DB Schema 支持<a href="https://uniapp.dcloud.net.cn/uniCloud/uni-id-summary" target="_blank" rel="noreferrer">uni-id</a>，可直接使用其角色和权限。无需再开发各种数据合法性校验和鉴权代码。</li><li><code>JQL</code>利用json数据库的嵌套特点，极大的简化了联表查询和树查询的复杂度，并支持更加灵活的虚拟表。</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 查询表</span></span>
<span class="line"><span style="color:#E5C07B;">db</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">collection</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;tableImages&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;">// 查询表</span></span>
<span class="line"><span style="color:#79B8FF;">db</span><span style="color:#B392F0;">.collection(</span><span style="color:#FFAB70;">&#39;tableImages&#39;</span><span style="color:#B392F0;">).get();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="新增数据" tabindex="-1">新增数据 <a class="header-anchor" href="#新增数据" aria-hidden="true">#</a></h3><p>获取到db的表对象后，通过add方法新增数据记录</p><h2 id="云函数传统方式和jql语法操作数据库的区别" tabindex="-1">云函数传统方式和jql语法操作数据库的区别 <a class="header-anchor" href="#云函数传统方式和jql语法操作数据库的区别" aria-hidden="true">#</a></h2><ul><li>主要查询方式上的区别，传统方式使用db.command，而jql使用js语法更易读更简洁</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">dbCmd</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">db</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">command</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">myOpenID</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;xxx&quot;</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">db</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">collection</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;articles&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">where</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">quarter</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">dbCmd</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">eq</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;2020 Q2&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">dbCmd</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">db</span><span style="color:#B392F0;">.command</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">myOpenID</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;xxx&quot;</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> res </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">db</span><span style="color:#B392F0;">.collection(</span><span style="color:#FFAB70;">&#39;articles&#39;</span><span style="color:#B392F0;">).where({</span></span>
<span class="line"><span style="color:#B392F0;">  quarter</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">dbCmd</span><span style="color:#B392F0;">.eq(</span><span style="color:#FFAB70;">&#39;2020 Q2&#39;</span><span style="color:#B392F0;">)</span></span>
<span class="line"><span style="color:#B392F0;">}).get()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="hbuilderx的jql数据库管理器" tabindex="-1">HBuilderX的JQL数据库管理器 <a class="header-anchor" href="#hbuilderx的jql数据库管理器" aria-hidden="true">#</a></h2><p>为方便开发者调试查询语句，<code>HBuilderX 3.1.5</code>起内置了JQL查询调试器。用法如下</p><ol><li>在<code>uniCloud/database</code>目录右键选择<code>新建JQL数据库管理</code>（HBuilderX创建项目时勾选uniCloud会自带一个jql文件，直接使用自带的jql文件也可以）</li><li>在jql文件内写上自己的语句</li><li>使用工具栏上的运行按钮运行（快捷键：Ctrl+R 或 F5）即可</li></ol><p><strong>注意</strong></p><ul><li>编写clientDB的js API（也支持常规js语法，比如var），可以对云数据库进行增删改查操作。不支持uniCloud-db组件写法</li><li>可以全部运行，也可以选中部分代码运行。点击工具栏上的运行按钮或者按下【F5】键运行代码</li><li>如果文档中存在多条JQL语句，只有最后一条语句生效</li><li>如果混写了普通js，最后一条语句需是数据库操作语句</li><li>此处代码运行不受DB Schema的权限控制，移植代码到实际业务中注意在schema中配好permission</li><li>不支持clientDB的action</li><li>数据库查询有最大返回条数限制，详见：[limit(opens new window)](</li></ul>`,14),p=[o];function c(r,t,i,d,B,y){return a(),n("div",null,p)}const h=s(e,[["render",c]]);export{u as __pageData,h as default};
