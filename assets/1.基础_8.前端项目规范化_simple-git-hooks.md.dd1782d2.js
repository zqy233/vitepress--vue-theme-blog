import{_ as s,o as n,c as a,a as o}from"./app.bfa9bd4b.js";const h=JSON.parse('{"title":"simple-git-hooks","description":"","frontmatter":{},"headers":[{"level":2,"title":"用法","slug":"用法","link":"#用法","children":[{"level":3,"title":"添加simple-git-hooks到项目中","slug":"添加simple-git-hooks到项目中","link":"#添加simple-git-hooks到项目中","children":[]},{"level":3,"title":"更新git钩子命令","slug":"更新git钩子命令","link":"#更新git钩子命令","children":[]},{"level":3,"title":"其他配置选项","slug":"其他配置选项","link":"#其他配置选项","children":[]},{"level":3,"title":"卸载simple-git-hooks","slug":"卸载simple-git-hooks","link":"#卸载simple-git-hooks","children":[]}]},{"level":2,"title":"常见问题","slug":"常见问题","link":"#常见问题","children":[{"level":3,"title":"当从husky迁移，git hooks 不运行了，为什么会发生这种情况","slug":"当从husky迁移-git-hooks-不运行了-为什么会发生这种情况","link":"#当从husky迁移-git-hooks-不运行了-为什么会发生这种情况","children":[]},{"level":3,"title":"如何修复？","slug":"如何修复","link":"#如何修复","children":[]}]}],"relativePath":"1.基础/8.前端项目规范化/simple-git-hooks.md","lastUpdated":1720835436686}'),p={name:"1.基础/8.前端项目规范化/simple-git-hooks.md"},l=o(`<h1 id="simple-git-hooks" tabindex="-1"><a href="https://www.npmjs.com/package/simple-git-hooks" target="_blank" rel="noreferrer">simple-git-hooks</a> <a class="header-anchor" href="#simple-git-hooks" aria-hidden="true">#</a></h1><p>一个让您轻松管理git钩子的工具</p><ul><li>零依赖</li><li>极少的配置（仅为package.json中的1个对象）</li><li>轻量</li></ul><h2 id="用法" tabindex="-1">用法 <a class="header-anchor" href="#用法" aria-hidden="true">#</a></h2><h3 id="添加simple-git-hooks到项目中" tabindex="-1">添加<code>simple-git-hooks</code>到项目中 <a class="header-anchor" href="#添加simple-git-hooks到项目中" aria-hidden="true">#</a></h3><ol><li><p>安装<code>simple-git-hooks</code>作为开发依赖项：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">simple-git-hooks</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">--save-dev</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm </span><span style="color:#9DB1C5;">install</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">simple-git-hooks</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">--save-dev</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>添加<code>simple-git-hooks</code> 到你的 <code>package.json</code>，用git钩子和相应的命令填充它 比如：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">&quot;simple-git-hooks&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;pre-commit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;npx lint-staged&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;pre-push&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// All unused hooks will be removed automatically by default</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// but you can use the \`preserveUnused\` option like following to prevent this behavior</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// if you&#39;d prefer preserve all unused hooks</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;preserveUnused&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// if you&#39;d prefer preserve specific unused hooks</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;preserveUnused&quot;</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;commit-msg&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">{</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F8F8F8;">&quot;simple-git-hooks&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F8F8F8;">&quot;pre-commit&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;npx lint-staged&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F8F8F8;">&quot;pre-push&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// All unused hooks will be removed automatically by default</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// but you can use the \`preserveUnused\` option like following to prevent this behavior</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// if you&#39;d prefer preserve all unused hooks</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F8F8F8;">&quot;preserveUnused&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">true</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// if you&#39;d prefer preserve specific unused hooks</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F8F8F8;">&quot;preserveUnused&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> [</span><span style="color:#FFAB70;">&quot;commit-msg&quot;</span><span style="color:#B392F0;">]</span></span>
<span class="line"><span style="color:#B392F0;">  }</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>此配置将在每次提交时运行所有linter，并在推送时运行格式化程序</p><blockquote><p>有更多的方法来配置<code>simple-git-hooks</code>，请查看<a href="https://www.npmjs.com/package/simple-git-hooks#additional-configuration-options" target="_blank" rel="noreferrer">其他配置选项</a>章节</p></blockquote></li><li><p>运行CLI脚本，使用config中的命令更新git挂钩：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># [Optional] These 2 steps can be skipped for non-husky users</span></span>
<span class="line"><span style="color:#61AFEF;">git</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">config</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">core.hooksPath</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">.git/hooks/</span></span>
<span class="line"><span style="color:#61AFEF;">rm</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-rf</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">.git/hooks</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Update ./git/hooks</span></span>
<span class="line"><span style="color:#61AFEF;">npx</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">simple-git-hooks</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;"># [Optional] These 2 steps can be skipped for non-husky users</span></span>
<span class="line"><span style="color:#B392F0;">git </span><span style="color:#9DB1C5;">config</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">core.hooksPath</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">.git/hooks/</span></span>
<span class="line"><span style="color:#B392F0;">rm </span><span style="color:#9DB1C5;">-rf</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">.git/hooks</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;"># Update ./git/hooks</span></span>
<span class="line"><span style="color:#B392F0;">npx </span><span style="color:#9DB1C5;">simple-git-hooks</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>现在，所有git钩子都已创建</p></li></ol><h3 id="更新git钩子命令" tabindex="-1">更新git钩子命令 <a class="header-anchor" href="#更新git钩子命令" aria-hidden="true">#</a></h3><ol><li>修改配置</li><li>在项目根目录运行运行<code>npx simple-git-hooks</code></li></ol><p>注意！对于<strong>yarn2</strong>用户: 请运行 <code>yarn dlx simple-git-hooks</code>取代上方命令. 更多信息请查看<a href="https://yarnpkg.com/cli/dlx" target="_blank" rel="noreferrer">dlx</a></p><p>注意！每次你更改命令，都应当手动运行<code>npx simple-git-hooks</code></p><h3 id="其他配置选项" tabindex="-1">其他配置选项 <a class="header-anchor" href="#其他配置选项" aria-hidden="true">#</a></h3><p>你还可以添加一个 <code>.simple-git-hooks.cjs</code>, <code>.simple-git-hooks.js</code>, <code>simple-git-hooks.cjs</code>, <code>simple-git-hooks.js</code>, <code>.simple-git-hooks.json</code> 或者 <code>simple-git-hooks.json</code>文件在项目中并且写入配置</p><p>这样 <code>simple-git-hooks</code> 在 <code>package.json</code> 中的配置将不再起效</p><p><code>.simple-git-hooks.cjs</code>, <code>.simple-git-hooks.js</code> 或者 <code>simple-git-hooks.cjs</code>, <code>simple-git-hooks.js</code>应当看起来是这样的：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;pre-commit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;npx lint-staged&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;pre-push&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#FFAB70;">&quot;pre-commit&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;npx lint-staged&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#FFAB70;">&quot;pre-push&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>.simple-git-hooks.json</code> or <code>simple-git-hooks.json</code>应当看起来是这样的：</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">&quot;pre-commit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;npx lint-staged&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">&quot;pre-push&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">{</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F8F8F8;">&quot;pre-commit&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;npx lint-staged&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F8F8F8;">&quot;pre-push&quot;</span><span style="color:#BBBBBB;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;cd ../../ &amp;&amp; npm run format&quot;</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果您需要有多个配置文件或你自己的配置文件，你可以手动下载hooks通过<code>npx simple-git-hooks ./my-config.js</code></p><h3 id="卸载simple-git-hooks" tabindex="-1">卸载simple-git-hooks <a class="header-anchor" href="#卸载simple-git-hooks" aria-hidden="true">#</a></h3><blockquote><p>卸载行为会移除所有存在的git hooks</p></blockquote><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">npm</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">uninstall</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">simple-git-hooks</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm </span><span style="color:#9DB1C5;">uninstall</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">simple-git-hooks</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-hidden="true">#</a></h2><h3 id="当从husky迁移-git-hooks-不运行了-为什么会发生这种情况" tabindex="-1">当从<code>husky</code>迁移，git hooks 不运行了，为什么会发生这种情况 <a class="header-anchor" href="#当从husky迁移-git-hooks-不运行了-为什么会发生这种情况" aria-hidden="true">#</a></h3><p><code>Husky</code>可能改变了 <code>core.gitHooks</code> 的值，因此，git hooks会搜索<code>.husky</code> 目录而不是 <code>.git/hooks/</code></p><p>阅读有关git配置的更多信息 <a href="https://git-scm.com/docs/githooks" target="_blank" rel="noreferrer">Git book</a></p><p>你可以通过在你仓库中运行下方命令来检查</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">git</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">config</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">core.hooksPath</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">git </span><span style="color:#9DB1C5;">config</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">core.hooksPath</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果输出<code>.husky</code> ，说明你遇到了这个情况</p><h3 id="如何修复" tabindex="-1">如何修复？ <a class="header-anchor" href="#如何修复" aria-hidden="true">#</a></h3><p>你需要指定<code>core.gitHooks</code> 的值为 <code>你的优秀项目/.git/hooks</code>，你可以使用这个命令</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">git</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">config</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">core.hooksPath</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">.git/hooks/</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">git </span><span style="color:#9DB1C5;">config</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">core.hooksPath</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">.git/hooks/</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>验证设置的值：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">git</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">config</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">core.hooksPath</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">git </span><span style="color:#9DB1C5;">config</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">core.hooksPath</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>应当输出: <code>.git/hooks/</code></p><p>然后移除之前由 <code>husky</code>生成的 <code>.husky</code> 文件</p>`,35),e=[l];function t(c,r,i,d,B,y){return n(),a("div",null,e)}const m=s(p,[["render",t]]);export{h as __pageData,m as default};
