import{_ as s,o as n,c as a,a as l}from"./app.bfa9bd4b.js";const u=JSON.parse('{"title":"xlsx","description":"","frontmatter":{},"headers":[{"level":2,"title":"导出js数据为Excel文件","slug":"导出js数据为excel文件","link":"#导出js数据为excel文件","children":[{"level":3,"title":"vue","slug":"vue","link":"#vue","children":[]}]},{"level":2,"title":"导入Excel文件生成js数据","slug":"导入excel文件生成js数据","link":"#导入excel文件生成js数据","children":[]},{"level":2,"title":"xlsx-js-style库使用","slug":"xlsx-js-style库使用","link":"#xlsx-js-style库使用","children":[]},{"level":2,"title":"去掉标题头","slug":"去掉标题头","link":"#去掉标题头","children":[]},{"level":2,"title":"设置列宽","slug":"设置列宽","link":"#设置列宽","children":[]},{"level":2,"title":"合并单元格","slug":"合并单元格","link":"#合并单元格","children":[]}],"relativePath":"4.库/xlsx/使用.md","lastUpdated":1720835436702}'),p={name:"4.库/xlsx/使用.md"},o=l(`<h1 id="xlsx" tabindex="-1">xlsx <a class="header-anchor" href="#xlsx" aria-hidden="true">#</a></h1><p><code>xlsx</code>是由<code>SheetJS</code>开发的一个处理excel文件的npm库</p><p>适用于前端开发者实现导入导出excel文件的经典需求</p><p>为了区别于xlsx文件，突出其应用语言，该库通常又被称为<code>js-xlsx</code></p><h2 id="导出js数据为excel文件" tabindex="-1">导出js数据为Excel文件 <a class="header-anchor" href="#导出js数据为excel文件" aria-hidden="true">#</a></h2><p>需要以下步骤：</p><ol><li>安装 xlsx 库 你可以使用 npm 包管理器安装 xlsx 库，也可以将 xlsx 下载到本地，然后在 HTML 文件中通过 script 标签引入。</li><li>准备数据 将需要导出的数据准备好，并将其存储为一个数组或对象。</li><li>创建工作簿 通过 xlsx 库的 <code>utils.book_new()</code> 方法创建一个工作簿（workbook）对象，该对象包含一个或多个工作表（worksheet）。</li><li>创建工作表 通过 xlsx 库的 <code>utils.json_to_sheet()</code> 方法创建一个工作表，并将准备好的数据作为参数传入该方法。如果需要创建多个工作表，可以多次调用该方法，并将它们添加到工作簿对象中。</li><li>将工作表添加到工作簿 通过 xlsx 库的 <code>utils.book_append_sheet()</code> 方法将创建好的工作表添加到工作簿对象中。</li><li>导出数据 通过 xlsx 库的 <code>writeFile()</code> 方法将工作簿对象导出为 Excel 文件。你可以指定导出的文件名和文件格式，比如 <code>.xlsx</code> 或 <code>.csv</code>。</li></ol><p>以下是一个使用 xlsx 库将数据导出为 Excel 文件的示例代码：</p><h3 id="vue" tabindex="-1">vue <a class="header-anchor" href="#vue" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">setup</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">import * as XLSX from &quot;xlsx/xlsx.mjs&quot;;</span></span>
<span class="line"><span style="color:#ABB2BF;">const download = () =&gt; </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;姓名&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;年龄&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;性别&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;张三&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;李四&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;女&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;王五&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  ];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_append_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;data.xlsx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">@click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;"> setup&gt;</span></span>
<span class="line"><span style="color:#B392F0;">import * as XLSX from &quot;xlsx/xlsx.mjs&quot;;</span></span>
<span class="line"><span style="color:#B392F0;">const download = () =&gt; {</span></span>
<span class="line"><span style="color:#B392F0;">  const data </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;姓名&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;年龄&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;性别&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;张三&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">18</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;李四&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">22</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;女&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;王五&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">25</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ];</span></span>
<span class="line"><span style="color:#B392F0;">  const workbook </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new();</span></span>
<span class="line"><span style="color:#B392F0;">  const worksheet </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.json_to_sheet(data);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_append_sheet(workbook</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> worksheet</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(workbook</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;data.xlsx&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">template</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  &lt;</span><span style="color:#FFAB70;">button</span><span style="color:#B392F0;"> @click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="导入excel文件生成js数据" tabindex="-1">导入Excel文件生成js数据 <a class="header-anchor" href="#导入excel文件生成js数据" aria-hidden="true">#</a></h2><ol><li>使用input type=&quot;file&quot;选择xlsx文件</li><li>使用fileReader读取文件为二进制编码</li><li>XLSX.read方法处理二进制编码为worksheet对象</li><li>XLSX.utils.sheet_to_json转换worksheet对象为json数据，实际上就是js数组</li><li>最后处理数组数据为自己想要的格式即可</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">article</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;">&gt;导入高德地图xlsx文件&lt;/</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">input</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">type</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;file&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">ref</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;upload&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">accept</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;.xls,.xlsx&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;/</span><span style="color:#E06C75;">article</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">import XLSX from &quot;xlsx&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">export default </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">mounted</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// 监听表格导入事件</span></span>
<span class="line"><span style="color:#ABB2BF;">    this.$refs.upload.addEventListener(</span><span style="color:#98C379;">&quot;change&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">e</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readExcel</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">methods</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">readExcel</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">//表格导入</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">files</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">target</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">files</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">//如果没有文件名，不往下执行</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">files</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// 上传文件格式不正确,非xls或者xlsx格式文件，不往下执行</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">/</span><span style="color:#56B6C2;">\\.</span><span style="color:#E06C75;">(xls</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">xlsx)</span><span style="color:#C678DD;">$</span><span style="color:#E06C75;">/</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">test</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">files</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#E5C07B;">name</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toLowerCase</span><span style="color:#ABB2BF;">())) </span><span style="color:#C678DD;">return</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">fileReader</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">FileReader</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// readAsBinaryString将文件读取为二进制编码</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">fileReader</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readAsBinaryString</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">files</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// 读取完成</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">fileReader</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onload</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">ev</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">// 二进制数据</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ev</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">target</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">result</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">// xlsx处理二进制数据</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;binary&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">          })</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">//取第一张表</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">wsname</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">SheetNames</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">] </span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">// 根据表格内容生成json数据</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sheet_to_json</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Sheets</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">wsname</span><span style="color:#ABB2BF;">]) </span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">outputs</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [] </span><span style="color:#7F848E;font-style:italic;">//清空接收数据</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ws</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">sheetData</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">adcode</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E06C75;">label</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">中文名</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">outputs</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">sheetData</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">          }</span></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">template</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  &lt;</span><span style="color:#FFAB70;">article</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">    &lt;</span><span style="color:#FFAB70;">p</span><span style="color:#B392F0;">&gt;导入高德地图xlsx文件&lt;/</span><span style="color:#FFAB70;">p</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">    &lt;</span><span style="color:#FFAB70;">input</span><span style="color:#B392F0;"> type</span><span style="color:#F97583;">=</span><span style="color:#FFAB70;">&quot;file&quot;</span><span style="color:#B392F0;"> ref</span><span style="color:#F97583;">=</span><span style="color:#FFAB70;">&quot;upload&quot;</span><span style="color:#B392F0;"> accept</span><span style="color:#F97583;">=</span><span style="color:#FFAB70;">&quot;.xls,.xlsx&quot;</span><span style="color:#B392F0;"> /&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  &lt;/</span><span style="color:#FFAB70;">article</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">template</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">import XLSX from &quot;xlsx&quot;</span></span>
<span class="line"><span style="color:#B392F0;">export default {</span></span>
<span class="line"><span style="color:#B392F0;">  mounted() {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// 监听表格导入事件</span></span>
<span class="line"><span style="color:#B392F0;">    this.$refs.upload.addEventListener(</span><span style="color:#FFAB70;">&quot;change&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> e </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.readExcel(e)</span></span>
<span class="line"><span style="color:#B392F0;">    })</span></span>
<span class="line"><span style="color:#B392F0;">  }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  methods: {</span></span>
<span class="line"><span style="color:#B392F0;">    readExcel(e) {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">//表格导入</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">files</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">e</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">target</span><span style="color:#B392F0;">.files</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">//如果没有文件名，不往下执行</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">files</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">length</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">&lt;=</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">) </span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// 上传文件格式不正确,非xls或者xlsx格式文件，不往下执行</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#F97583;">!</span><span style="color:#FFAB70;">/\\.(xls</span><span style="color:#F97583;">|</span><span style="color:#FFAB70;">xlsx)</span><span style="color:#F97583;">$</span><span style="color:#FFAB70;">/</span><span style="color:#B392F0;">.test(files[</span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">].</span><span style="color:#79B8FF;">name</span><span style="color:#B392F0;">.toLowerCase())) </span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">fileReader</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> FileReader()</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// readAsBinaryString将文件读取为二进制编码</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">fileReader</span><span style="color:#B392F0;">.readAsBinaryString(files[</span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">])</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// 读取完成</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">fileReader</span><span style="color:#B392F0;">.onload </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> ev </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">try</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">// 二进制数据</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">data</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">ev</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">target</span><span style="color:#B392F0;">.result</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">// xlsx处理二进制数据</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.read(data</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">            type</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;binary&quot;</span></span>
<span class="line"><span style="color:#B392F0;">          })</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">//取第一张表</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">wsname</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;">.SheetNames[</span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">] </span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">// 根据表格内容生成json数据</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">ws</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.sheet_to_json(</span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;">.Sheets[wsname]) </span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">outputs</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [] </span><span style="color:#6B737C;">//清空接收数据</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">for</span><span style="color:#B392F0;"> (</span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> i </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">ws</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">length</span><span style="color:#B392F0;">; i</span><span style="color:#F97583;">++</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">sheetData</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">              value</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ws[i].adcode</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">              label</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ws[i].中文名</span></span>
<span class="line"><span style="color:#B392F0;">            }</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">outputs</span><span style="color:#B392F0;">.push(sheetData)</span></span>
<span class="line"><span style="color:#B392F0;">          }</span></span>
<span class="line"><span style="color:#B392F0;">        } </span><span style="color:#F97583;">catch</span><span style="color:#B392F0;"> (e) {</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(e)</span></span>
<span class="line"><span style="color:#B392F0;">        }</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"><span style="color:#B392F0;">    }</span></span>
<span class="line"><span style="color:#B392F0;">  }</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h2 id="xlsx-js-style库使用" tabindex="-1">xlsx-js-style库使用 <a class="header-anchor" href="#xlsx-js-style库使用" aria-hidden="true">#</a></h2><p>xlsx基础库不提供样式设置，可以使用xlsx-js-style库，这个库是xlsx库的fork版本，并添加了样式定义</p><p>详细样式可以查看<a href="https://github.com/gitbrent/xlsx-js-style/" target="_blank" rel="noreferrer">https://github.com/gitbrent/xlsx-js-style/</a></p><p>可以调节背景色、字体样式、border</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#E06C75;">npm</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">xlsx</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">js</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">style</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm i </span><span style="color:#F97583;">-</span><span style="color:#B392F0;">s xlsx</span><span style="color:#F97583;">-</span><span style="color:#B392F0;">js</span><span style="color:#F97583;">-</span><span style="color:#B392F0;">style</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">setup</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#ABB2BF;">console.log();</span></span>
<span class="line"><span style="color:#ABB2BF;">const download = () =&gt; </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">aoa_to_sheet</span><span style="color:#ABB2BF;">([</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;Hello&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;World&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  ]);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 在单元格对象中添加 \`s\` 属性来设置该单元格的样式</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;A1&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">font</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">bold</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">alignment</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">horizontal</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;center&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">fill</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">fgColor</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">rgb</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;FFFF0000&quot;</span><span style="color:#ABB2BF;"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;B2&quot;</span><span style="color:#ABB2BF;">].</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">alignment</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">horizontal</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;center&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">font</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">bold</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">fill</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">fgColor</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">rgb</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;FFFF0000&quot;</span><span style="color:#ABB2BF;"> } },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_append_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;example.xlsx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;"> setup&gt;</span></span>
<span class="line"><span style="color:#B392F0;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#B392F0;">console.log();</span></span>
<span class="line"><span style="color:#B392F0;">const download = () =&gt; {</span></span>
<span class="line"><span style="color:#B392F0;">  const wb </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new();</span></span>
<span class="line"><span style="color:#B392F0;">  const ws </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.aoa_to_sheet([</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;Hello&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;World&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#F8F8F8;">1</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">2</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ]);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 在单元格对象中添加 \`s\` 属性来设置该单元格的样式</span></span>
<span class="line"><span style="color:#B392F0;">  ws[</span><span style="color:#FFAB70;">&quot;A1&quot;</span><span style="color:#B392F0;">].s </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    font</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { bold</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">true</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    alignment</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { horizontal</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;center&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    fill</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { fgColor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { rgb</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FFFF0000&quot;</span><span style="color:#B392F0;"> } }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">  ws[</span><span style="color:#FFAB70;">&quot;B2&quot;</span><span style="color:#B392F0;">].s </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    alignment</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { horizontal</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;center&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    font</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { bold</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">true</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    fill</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { fgColor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { rgb</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FFFF0000&quot;</span><span style="color:#B392F0;"> } }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_append_sheet(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;example.xlsx&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="去掉标题头" tabindex="-1">去掉标题头 <a class="header-anchor" href="#去掉标题头" aria-hidden="true">#</a></h2><p><code>XLSX.utils.json_to_sheet</code>默认使用<code>Object.keys</code>生成头部</p><p>所以如下数据格式不加上<code>skipHeader: true</code>,会出现<code>0 1 2</code>的索引头部</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">setup</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">XLSX</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;xlsx-js-style&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">download</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;姓名&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;年龄&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;性别&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;张三&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;李四&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;女&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#98C379;">&quot;王五&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  ];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">wb</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">skipHeader</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  });</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_append_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;example.xlsx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#56B6C2;">&lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> @</span><span style="color:#E06C75;">click</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;download&quot;</span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;">导出</span><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">button</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"><span style="color:#56B6C2;">&lt;/</span><span style="color:#E06C75;">template</span><span style="color:#56B6C2;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;">script setup</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#B392F0;"> XLSX </span><span style="color:#F97583;">from</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;xlsx-js-style&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> download </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">data</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;姓名&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;年龄&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;性别&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;张三&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">18</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;李四&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">22</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;女&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    [</span><span style="color:#FFAB70;">&quot;王五&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">25</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ];</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">wb</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new();</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">ws</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.json_to_sheet(data</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    skipHeader</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">true</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  });</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_append_sheet(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;example.xlsx&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"><span style="color:#F97583;">&lt;/</span><span style="color:#B392F0;">script</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&lt;template&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">&lt;</span><span style="color:#B392F0;">button @click</span><span style="color:#F97583;">=</span><span style="color:#FFAB70;">&quot;download&quot;</span><span style="color:#F97583;">&gt;</span><span style="color:#B392F0;">导出</span><span style="color:#F97583;">&lt;/</span><span style="color:#B392F0;">button</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">&lt;/</span><span style="color:#B392F0;">template</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="设置列宽" tabindex="-1">设置列宽 <a class="header-anchor" href="#设置列宽" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">setup</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#ABB2BF;">const download = () =&gt; </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;张三&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;李四&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;女&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;王五&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">  ];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;!cols&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">wpx</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">wpx</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">wpx</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  ];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_append_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;example.xlsx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">@click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;"> setup&gt;</span></span>
<span class="line"><span style="color:#B392F0;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#B392F0;">const download = () =&gt; {</span></span>
<span class="line"><span style="color:#B392F0;">  const data </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;张三&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">18</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;李四&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">20</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;女&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;王五&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">22</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ];</span></span>
<span class="line"><span style="color:#B392F0;">  const wb </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new();</span></span>
<span class="line"><span style="color:#B392F0;">  const ws </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.json_to_sheet(data);</span></span>
<span class="line"><span style="color:#B392F0;">  ws[</span><span style="color:#FFAB70;">&quot;!cols&quot;</span><span style="color:#B392F0;">] </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">    {</span></span>
<span class="line"><span style="color:#B392F0;">      wpx</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">150</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    {</span></span>
<span class="line"><span style="color:#B392F0;">      wpx</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">500</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    {</span></span>
<span class="line"><span style="color:#B392F0;">      wpx</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">100</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ];</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_append_sheet(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;example.xlsx&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">template</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  &lt;</span><span style="color:#FFAB70;">button</span><span style="color:#B392F0;"> @click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="合并单元格" tabindex="-1">合并单元格 <a class="header-anchor" href="#合并单元格" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;font-style:italic;">setup</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#ABB2BF;">const download = () =&gt; </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;张三&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;李四&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;女&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">    { </span><span style="color:#E06C75;">姓名</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;王五&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">年龄</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">性别</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;男&quot;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">  ];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// s 表示要合并的单元格范围的左上角单元格，r 表示该单元格的行号，c 表示该单元格的列号，行列号从 0 开始计数。所以 { r: 0, c: 0 } 表示第 1 行第 1 列的单元格，即 A1 单元格。</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// e 表示要合并的单元格范围的右下角单元格，其含义与 s 相同。所以 { r: 0, c: 1 } 表示第 1 行第 2 列的单元格，即 B1 单元格。</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 因此，{ s: { r: 0, c: 0 }, e: { r: 0, c: 1 } } 表示要合并第 1 行第 1 列和第 1 行第 3 列之间的元格。</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 注意，合并会以开始位置单元格中的内容为准，所以合并后的单元格中的内容为 A1 单元格中的内容。</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;!merges&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [{ </span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">r</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> }, </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">: { </span><span style="color:#E06C75;">r</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;"> } }];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_append_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">wb</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;example.xlsx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">template</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">@click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#FFFFFF;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;"> setup&gt;</span></span>
<span class="line"><span style="color:#B392F0;">import XLSX from &quot;xlsx-js-style&quot;;</span></span>
<span class="line"><span style="color:#B392F0;">const download = () =&gt; {</span></span>
<span class="line"><span style="color:#B392F0;">  const data </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;张三&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">18</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;李四&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">20</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;女&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    { 姓名</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;王五&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 年龄</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">22</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> 性别</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;男&quot;</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  ];</span></span>
<span class="line"><span style="color:#B392F0;">  const wb </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new();</span></span>
<span class="line"><span style="color:#B392F0;">  const ws </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.json_to_sheet(data);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// s 表示要合并的单元格范围的左上角单元格，r 表示该单元格的行号，c 表示该单元格的列号，行列号从 0 开始计数。所以 { r: 0, c: 0 } 表示第 1 行第 1 列的单元格，即 A1 单元格。</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// e 表示要合并的单元格范围的右下角单元格，其含义与 s 相同。所以 { r: 0, c: 1 } 表示第 1 行第 2 列的单元格，即 B1 单元格。</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 因此，{ s: { r: 0, c: 0 }, e: { r: 0, c: 1 } } 表示要合并第 1 行第 1 列和第 1 行第 3 列之间的元格。</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 注意，合并会以开始位置单元格中的内容为准，所以合并后的单元格中的内容为 A1 单元格中的内容。</span></span>
<span class="line"><span style="color:#B392F0;">  ws[</span><span style="color:#FFAB70;">&quot;!merges&quot;</span><span style="color:#B392F0;">] </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [{ s</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { r</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> c</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#B392F0;"> }</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> e</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { r</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">0</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> c</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">2</span><span style="color:#B392F0;"> } }];</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_append_sheet(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(wb</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;example.xlsx&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/</span><span style="color:#FFAB70;">script</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&lt;</span><span style="color:#FFAB70;">template</span><span style="color:#B392F0;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">  &lt;</span><span style="color:#FFAB70;">button</span><span style="color:#B392F0;"> @click=&quot;download&quot;&gt;导出&lt;/button&gt;</span></span>
<span class="line"><span style="color:#B392F0;">&lt;/template&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div>`,27),e=[o];function t(B,c,r,y,F,i){return n(),a("div",null,e)}const b=s(p,[["render",t]]);export{u as __pageData,b as default};
