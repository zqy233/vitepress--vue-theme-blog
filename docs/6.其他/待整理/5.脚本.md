# 谷歌浏览器插件

## 油猴

极速插件网下载 

greasyfork网下载需要的插件

https://greasyfork.org/zh-CN/scripts

## 自动导出日志

```js
// 合同名称
const name = "2023年徐州调度大屏可视化系统运行维护服务"
// 日志类型
const type = "项目开发"
// 时间（月日不要写0）, 下标对应工作内容数组
const timeArr = ["2023年4月3日"]
// 工作内容
const contentArr = ["搭建徐州市版本项目",
                    "集成新能源模块到徐州市版本项目",
                   "前后端联调数据，跟进现场部署"]
const durationArr = [3,2,2.5]

// for循环中依次执行异步操作
async function func () {
  for (let i = 0; i < contentArr.length; i++) {
    await run(durationArr[i], timeArr[0], contentArr[i])
  }
}
func()

function run(duration, time, content) {
  return new Promise((runResolve, reject) => {
    function first() {
      // 点击新增
      document.querySelector("button").click()
      return new Promise((resolve, reject) => {
        // 打开合同名称下拉框
        setTimeout(() => {
          document.querySelectorAll(".ant-select-selection__rendered")[2].click()
          resolve()
        }, 0)
      })
    }

    function two() {
      return new Promise((resolve, reject) => {
        // 选择合同名称下拉框
        setTimeout(() => {
          const collection = document.querySelectorAll(".ant-select-dropdown-menu-item")
          let neededDom = null
          for (let dom of collection) {
              console.log(dom.innerText,name,dom.innerText === name)
            if (dom.innerText === name) {
              neededDom = dom
            }
          }
          neededDom.click()
          resolve()
        },1000)
      })
    }

    function three() {
      return new Promise((resolve, reject) => {
        // 打开日志类型下拉框
        setTimeout(() => {
          document.querySelectorAll(".ant-select-selection__rendered")[3].click()
          resolve()
        }, 0)
      })
    }

    function four() {
      return new Promise((resolve, reject) => {
        // 选择日志类型下拉框
        setTimeout(() => {
          const collection = document.querySelectorAll(".ant-select-dropdown-menu-item")
          let neededDom = null
          for (let dom of collection) {
            if (dom.innerText === type) {
              neededDom = dom
            }
          }
          neededDom.click()
          resolve()
        }, 0)
      })
    }

    function five() {
      return new Promise((resolve, reject) => {
        // 打开日期下拉框
        setTimeout(() => {
          document.querySelectorAll(".ant-calendar-picker-input")[2].click()
          setTimeout(()=>{
           // 选择月份
           document.querySelectorAll(".ant-calendar-month-select")[0].click()
          },200)
          setTimeout(()=>{
            // 根据日期选择第几月
            document.querySelectorAll(".ant-calendar-month-panel-cell")[new Date(Date.parse(time.replace('年','-').replace('月','-').replace('日',''))).getMonth()].click()
            resolve()
          },500)
        }, 0)
      })
    }

    function six() {
      return new Promise((resolve, reject) => {
        // 日期下拉框选择日
        setTimeout(() => {
          const collection = document.querySelectorAll(".ant-calendar-cell")
          let neededDom = null
          for (let dom of collection) { 
            if (dom.getAttribute("title") === time) {
              neededDom = dom
            }
          }
          neededDom.click()
          resolve()
        }, 200)
      })
    }

    function seven() {
      return new Promise((resolve, reject) => {
        // 设置时长
        setTimeout(() => {
          document.querySelectorAll(".ant-input-number-input")[0].value = duration
          document.querySelectorAll(".ant-input-number-input")[0].dispatchEvent(new Event("input"))
          resolve()
        }, 0)
      })
    }

    function eight() {
      return new Promise((resolve, reject) => {
        // 设置工作内容
        setTimeout(() => {
          document.querySelectorAll(".ant-input")[3].value = content
          document.querySelectorAll(".ant-input")[3].dispatchEvent(new Event("input"))
          resolve()
        }, 0)
      })
    }

    function nine() {
      return new Promise((resolve, reject) => {
        // 保存
        setTimeout(() => {
          document.querySelector(".save").click()
          setTimeout(() => {
            resolve()
          }, 500)
        }, 0)
      })
    }
    // 执行测试
    first()
      .then(() => {
        return two()
      })
      .then(() => {
        return three()
      })
      .then(() => {
        return four()
      })
      .then(() => {
        return five()
      })
      .then(() => {
        return six()
      })
      .then(() => {
        return seven()
      })
      .then(() => {
        return eight()
      })
      .then(() => {
        return nine()
      })
      .then(() => {
        runResolve()
      })
      .catch(err => {
        console.log(err)
      })
  })
}
```

