import{_ as s,c as n,o as a,a as l}from"./app.a9997904.js";const d=JSON.parse('{"title":"excel","description":"","frontmatter":{},"headers":[{"level":2,"title":"按照xlsx","slug":"按照xlsx","link":"#按照xlsx","children":[]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[]},{"level":2,"title":"处理JSON和JS数据","slug":"处理json和js数据","link":"#处理json和js数据","children":[{"level":3,"title":"创建新工作簿","slug":"创建新工作簿","link":"#创建新工作簿","children":[]}]},{"level":2,"title":"打印","slug":"打印","link":"#打印","children":[{"level":3,"title":"直接window.print","slug":"直接window-print","link":"#直接window-print","children":[]},{"level":3,"title":"innerHTML指定内容","slug":"innerhtml指定内容","link":"#innerhtml指定内容","children":[]},{"level":3,"title":"html2canvas","slug":"html2canvas","link":"#html2canvas","children":[]}]}],"relativePath":"3.前端框架/1.vue/8.功能实现.md","lastUpdated":1676276426000}'),p={name:"3.前端框架/1.vue/8.功能实现.md"},o=l(`<h1 id="excel" tabindex="-1">excel <a class="header-anchor" href="#excel" aria-hidden="true">#</a></h1><h2 id="按照xlsx" tabindex="-1">按照xlsx <a class="header-anchor" href="#按照xlsx" aria-hidden="true">#</a></h2><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">npm </span><span style="color:#98C379;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-s</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">xlsx</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#B392F0;">npm </span><span style="color:#9DB1C5;">i</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">-s</span><span style="color:#B392F0;"> </span><span style="color:#9DB1C5;">xlsx</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// Acquire Data (reference to the HTML table)</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">table_elt</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;my-table-id&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Extract Data (create a workbook object from the table)</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">table_to_book</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">table_elt</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Process Data (add a new row)</span></span>
<span class="line"><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">workbook</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Sheets</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;Sheet1&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sheet_add_aoa</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">ws</span><span style="color:#ABB2BF;">, [[</span><span style="color:#98C379;">&quot;Created &quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toISOString</span><span style="color:#ABB2BF;">()]], { </span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> })</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Package and Release Data (\`writeFile\` tries to write and save an XLSB file)</span></span>
<span class="line"><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">writeFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Report.xlsb&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#6B737C;">// Acquire Data (reference to the HTML table)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">table_elt</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">document</span><span style="color:#B392F0;">.getElementById(</span><span style="color:#FFAB70;">&quot;my-table-id&quot;</span><span style="color:#B392F0;">)</span></span>
<span class="line"><span style="color:#6B737C;">// Extract Data (create a workbook object from the table)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.table_to_book(table_elt)</span></span>
<span class="line"><span style="color:#6B737C;">// Process Data (add a new row)</span></span>
<span class="line"><span style="color:#B392F0;">c ws </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">workbook</span><span style="color:#B392F0;">.Sheets[</span><span style="color:#FFAB70;">&quot;Sheet1&quot;</span><span style="color:#B392F0;">]</span></span>
<span class="line"><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.sheet_add_aoa(ws</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> [[</span><span style="color:#FFAB70;">&quot;Created &quot;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">+</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Date().toISOString()]]</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> { origin</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">-</span><span style="color:#F8F8F8;">1</span><span style="color:#B392F0;"> })</span></span>
<span class="line"><span style="color:#6B737C;">// Package and Release Data (\`writeFile\` tries to write and save an XLSB file)</span></span>
<span class="line"><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.writeFile(workbook</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Report.xlsb&quot;</span><span style="color:#B392F0;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="处理json和js数据" tabindex="-1">处理JSON和JS数据 <a class="header-anchor" href="#处理json和js数据" aria-hidden="true">#</a></h2><p>JSON和JS数据往往表示单个工作表。本节将使用一些实用函数来生成工作簿</p><h3 id="创建新工作簿" tabindex="-1">创建新工作簿 <a class="header-anchor" href="#创建新工作簿" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">workbook</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">book_new</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> workbook </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.book_new()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>book_new函数创建一个没有工作表的空工作簿 电子表格软件通常至少需要一份工作表，并在用户界面中强制执行该要求。xlsx库在写入时强制执行该要求，如果将空工作簿传递给写入函数，则会引发错误</p><p>JS数组创建工作表</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">aoa_to_sheet</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">aoa</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">opts</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> worksheet </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.aoa_to_sheet(aoa</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> opts)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>以下代码生成了一个工作表，其中单元格A1设置为字符串A1，单元格B1设置为B1，等等：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">worksheet</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">XLSX</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">utils</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">aoa_to_sheet</span><span style="color:#ABB2BF;">([</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C1&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A2&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B2&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C2&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  [</span><span style="color:#98C379;">&quot;A3&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;B3&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;C3&quot;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">])</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> worksheet </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">XLSX</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">utils</span><span style="color:#B392F0;">.aoa_to_sheet([</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A1&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B1&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C1&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A2&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B2&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C2&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  [</span><span style="color:#FFAB70;">&quot;A3&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;B3&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;C3&quot;</span><span style="color:#B392F0;">]</span></span>
<span class="line"><span style="color:#B392F0;">])</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>aoa_to_sheet默认情况下，为数组中的每个对象生成一个标题行和一行。可选opts参数具有控制列顺序和标题输出的设置</p><h2 id="打印" tabindex="-1">打印 <a class="header-anchor" href="#打印" aria-hidden="true">#</a></h2><h3 id="直接window-print" tabindex="-1">直接window.print <a class="header-anchor" href="#直接window-print" aria-hidden="true">#</a></h3><p>可以保留页面样式</p><p>但是打印整个页面，会存在多余部分</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#79B8FF;">window</span><span style="color:#B392F0;">.print()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="innerhtml指定内容" tabindex="-1">innerHTML指定内容 <a class="header-anchor" href="#innerhtml指定内容" aria-hidden="true">#</a></h3><p>打印样式会丢失</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">innerHTML</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">innerHTML</span></span>
<span class="line"><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">innerHTML</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">$refs</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">content</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">innerHTML</span></span>
<span class="line"><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#E5C07B;">location</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reload</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">innerHTML</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">document</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">body</span><span style="color:#B392F0;">.innerHTML</span></span>
<span class="line"><span style="color:#79B8FF;">document</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">body</span><span style="color:#B392F0;">.innerHTML </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">$refs</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">content</span><span style="color:#B392F0;">.innerHTML</span></span>
<span class="line"><span style="color:#79B8FF;">window</span><span style="color:#B392F0;">.print()</span></span>
<span class="line"><span style="color:#79B8FF;">location</span><span style="color:#B392F0;">.reload()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="html2canvas" tabindex="-1">html2canvas <a class="header-anchor" href="#html2canvas" aria-hidden="true">#</a></h3><p>存在显示不全的问题，暂时无法解决</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro vp-code-dark" tabindex="0"><code><span class="line"><span style="color:#abb2bf;">花了一下午，主要是调研几种打印页面指定元素最终的实现效果，最终还是\`print-js\`效果度符合要求</span></span>
<span class="line"><span style="color:#abb2bf;">### 开始踩坑：</span></span>
<span class="line"><span style="color:#abb2bf;">#### 1.打印的元素显示不全</span></span>
<span class="line"><span style="color:#abb2bf;">原因是默认maxWidth属性是800，元素超过了，需要自行调整下maxWidth属性</span></span>
<span class="line"><span style="color:#abb2bf;">#### 2.打印时font-size字体大小失效</span></span>
<span class="line"><span style="color:#abb2bf;">翻了下\`print-js\`的github issues找到一种解决方案，设置\`font_size: &quot;&quot;\`,</span></span>
<span class="line"><span style="color:#abb2bf;">#### 3.font-family自定义字体失效</span></span>
<span class="line"><span style="color:#abb2bf;">没找到相关资料，最终花时间看了下源码</span></span>
<span class="line"><span style="color:#abb2bf;">\`print-js\`是基于\`iframe\`实现，\`style\`属性作为样式插入到\`iframe\`中，那就简单了，传递一下\`@font-face\`字符串</span></span>
<span class="line"><span style="color:#abb2bf;">重点在于开发环境和生产环境的文件地址不一样，所以我把地址挂在了window对象上</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`js</span></span>
<span class="line"><span style="color:#abb2bf;">import printjs from &quot;print-js&quot;</span></span>
<span class="line"><span style="color:#abb2bf;">export default {</span></span>
<span class="line"><span style="color:#abb2bf;">methods: {</span></span>
<span class="line"><span style="color:#abb2bf;">  print() {</span></span>
<span class="line"><span style="color:#abb2bf;">      printjs({</span></span>
<span class="line"><span style="color:#abb2bf;">        // 打印页面的dom</span></span>
<span class="line"><span style="color:#abb2bf;">        printable: this.$refs.content,</span></span>
<span class="line"><span style="color:#abb2bf;">        type: &quot;html&quot;,</span></span>
<span class="line"><span style="color:#abb2bf;">        maxWidth: 1150, // 最大宽度</span></span>
<span class="line"><span style="color:#abb2bf;">        font_size: &quot;&quot;, // 不设置则使用默认字体大小</span></span>
<span class="line"><span style="color:#abb2bf;">        style: \`@font-face {</span></span>
<span class="line"><span style="color:#abb2bf;">          font-family: &quot;STZHONGS&quot;;</span></span>
<span class="line"><span style="color:#abb2bf;">          src: url(\${window.ttf}) format(&quot;truetype&quot;);</span></span>
<span class="line"><span style="color:#abb2bf;">        }\`,</span></span>
<span class="line"><span style="color:#abb2bf;">        // 继承原来的所有样式</span></span>
<span class="line"><span style="color:#abb2bf;">        targetStyles: [&quot;*&quot;],</span></span>
<span class="line"><span style="color:#abb2bf;">      })</span></span>
<span class="line"><span style="color:#abb2bf;">    }</span></span>
<span class="line"><span style="color:#abb2bf;">  }</span></span>
<span class="line"><span style="color:#abb2bf;">}</span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`</span></span>
<span class="line"><span style="color:#abb2bf;">我的项目是基于vite的，html中加入\`&lt;script src=&quot;./config.js&quot;&gt;&lt;/script&gt;\`，vite只会打包\`type=&quot;module&quot;\`的script标签，这样config.js就不会被打包压缩，就可以用于写入一些不管开发还是打包后，都可以任意更改的配置项</span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`html</span></span>
<span class="line"><span style="color:#abb2bf;">&lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">&lt;html lang=&quot;en&quot;&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">  &lt;head&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;link rel=&quot;icon&quot; href=&quot;/favicon.ico&quot; /&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    // 新增</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;script src=&quot;./config.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;title&gt;Vite App&lt;/title&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">  &lt;/head&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">  &lt;body&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">    &lt;script type=&quot;module&quot; src=&quot;/src/main.ts&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">  &lt;/body&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">&lt;/html&gt;</span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`</span></span>
<span class="line"><span style="color:#abb2bf;">config.js</span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`js</span></span>
<span class="line"><span style="color:#abb2bf;">// 字体文件路径，用于打印设置，print.js源码基于iframe实现，需要指定字体路径到iframe中</span></span>
<span class="line"><span style="color:#abb2bf;">// 开发</span></span>
<span class="line"><span style="color:#abb2bf;">window.ttf = &quot;http://192.168.4.237:9010/src/assets/font/chinese.stzhongs.ttf&quot;</span></span>
<span class="line"><span style="color:#abb2bf;">// 线上</span></span>
<span class="line"><span style="color:#abb2bf;">// window.ttf = &quot;http://192.168.4.238:9010/test/assets/font/chinese.stzhongs.ttf&quot;</span></span>
<span class="line"><span style="color:#abb2bf;">\`\`\`</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre><pre class="shiki min-dark vp-code-light" tabindex="0"><code><span class="line"><span style="color:#b392f0;">花了一下午，主要是调研几种打印页面指定元素最终的实现效果，最终还是\`print-js\`效果度符合要求</span></span>
<span class="line"><span style="color:#b392f0;">### 开始踩坑：</span></span>
<span class="line"><span style="color:#b392f0;">#### 1.打印的元素显示不全</span></span>
<span class="line"><span style="color:#b392f0;">原因是默认maxWidth属性是800，元素超过了，需要自行调整下maxWidth属性</span></span>
<span class="line"><span style="color:#b392f0;">#### 2.打印时font-size字体大小失效</span></span>
<span class="line"><span style="color:#b392f0;">翻了下\`print-js\`的github issues找到一种解决方案，设置\`font_size: &quot;&quot;\`,</span></span>
<span class="line"><span style="color:#b392f0;">#### 3.font-family自定义字体失效</span></span>
<span class="line"><span style="color:#b392f0;">没找到相关资料，最终花时间看了下源码</span></span>
<span class="line"><span style="color:#b392f0;">\`print-js\`是基于\`iframe\`实现，\`style\`属性作为样式插入到\`iframe\`中，那就简单了，传递一下\`@font-face\`字符串</span></span>
<span class="line"><span style="color:#b392f0;">重点在于开发环境和生产环境的文件地址不一样，所以我把地址挂在了window对象上</span></span>
<span class="line"><span style="color:#b392f0;"></span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`js</span></span>
<span class="line"><span style="color:#b392f0;">import printjs from &quot;print-js&quot;</span></span>
<span class="line"><span style="color:#b392f0;">export default {</span></span>
<span class="line"><span style="color:#b392f0;">methods: {</span></span>
<span class="line"><span style="color:#b392f0;">  print() {</span></span>
<span class="line"><span style="color:#b392f0;">      printjs({</span></span>
<span class="line"><span style="color:#b392f0;">        // 打印页面的dom</span></span>
<span class="line"><span style="color:#b392f0;">        printable: this.$refs.content,</span></span>
<span class="line"><span style="color:#b392f0;">        type: &quot;html&quot;,</span></span>
<span class="line"><span style="color:#b392f0;">        maxWidth: 1150, // 最大宽度</span></span>
<span class="line"><span style="color:#b392f0;">        font_size: &quot;&quot;, // 不设置则使用默认字体大小</span></span>
<span class="line"><span style="color:#b392f0;">        style: \`@font-face {</span></span>
<span class="line"><span style="color:#b392f0;">          font-family: &quot;STZHONGS&quot;;</span></span>
<span class="line"><span style="color:#b392f0;">          src: url(\${window.ttf}) format(&quot;truetype&quot;);</span></span>
<span class="line"><span style="color:#b392f0;">        }\`,</span></span>
<span class="line"><span style="color:#b392f0;">        // 继承原来的所有样式</span></span>
<span class="line"><span style="color:#b392f0;">        targetStyles: [&quot;*&quot;],</span></span>
<span class="line"><span style="color:#b392f0;">      })</span></span>
<span class="line"><span style="color:#b392f0;">    }</span></span>
<span class="line"><span style="color:#b392f0;">  }</span></span>
<span class="line"><span style="color:#b392f0;">}</span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`</span></span>
<span class="line"><span style="color:#b392f0;">我的项目是基于vite的，html中加入\`&lt;script src=&quot;./config.js&quot;&gt;&lt;/script&gt;\`，vite只会打包\`type=&quot;module&quot;\`的script标签，这样config.js就不会被打包压缩，就可以用于写入一些不管开发还是打包后，都可以任意更改的配置项</span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`html</span></span>
<span class="line"><span style="color:#b392f0;">&lt;!DOCTYPE html&gt;</span></span>
<span class="line"><span style="color:#b392f0;">&lt;html lang=&quot;en&quot;&gt;</span></span>
<span class="line"><span style="color:#b392f0;">  &lt;head&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;link rel=&quot;icon&quot; href=&quot;/favicon.ico&quot; /&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    // 新增</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;script src=&quot;./config.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;title&gt;Vite App&lt;/title&gt;</span></span>
<span class="line"><span style="color:#b392f0;">  &lt;/head&gt;</span></span>
<span class="line"><span style="color:#b392f0;">  &lt;body&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#b392f0;">    &lt;script type=&quot;module&quot; src=&quot;/src/main.ts&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#b392f0;">  &lt;/body&gt;</span></span>
<span class="line"><span style="color:#b392f0;">&lt;/html&gt;</span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`</span></span>
<span class="line"><span style="color:#b392f0;">config.js</span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`js</span></span>
<span class="line"><span style="color:#b392f0;">// 字体文件路径，用于打印设置，print.js源码基于iframe实现，需要指定字体路径到iframe中</span></span>
<span class="line"><span style="color:#b392f0;">// 开发</span></span>
<span class="line"><span style="color:#b392f0;">window.ttf = &quot;http://192.168.4.237:9010/src/assets/font/chinese.stzhongs.ttf&quot;</span></span>
<span class="line"><span style="color:#b392f0;">// 线上</span></span>
<span class="line"><span style="color:#b392f0;">// window.ttf = &quot;http://192.168.4.238:9010/test/assets/font/chinese.stzhongs.ttf&quot;</span></span>
<span class="line"><span style="color:#b392f0;">\`\`\`</span></span>
<span class="line"><span style="color:#b392f0;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div>`,26),e=[o];function t(c,r,i,b,B,y){return a(),n("div",null,e)}const F=s(p,[["render",t]]);export{d as __pageData,F as default};
